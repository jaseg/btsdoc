<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="generator" content="Docutils 0.13.1: http://docutils.sourceforge.net/" />
<title>Database Structure of the BTSv3</title>
<link rel="stylesheet" href="bootstrap.css" type="text/css" />
<link rel="stylesheet" href="style.css" type="text/css" />
</head>
<body>
<div class="document" id="database-structure-of-the-btsv3">
<h1 class="title">Database Structure of the BTSv3</h1>

<div class="section" id="introduction">
<h1>Introduction</h1>
<p>BTS version 3 is running on a CouchDB. There is a single central instance as well as one local instance per BTS3
installation. The local instances are kept in sync with the central instance using the synchronization feature built
into CouchDB. The java process of a BTS3 instance talks to its local CouchDB instance using HTTP against localhost.
Embedded into the BTS3 java process is an Elasticsearch instance that is fed from the local couchdb. This
synchronization being only half working is the reason one frequently must manually kick of &quot;indexing&quot; actions from a
complaining BTS3 dialog.</p>
<p>This document starts out with an overview of all object types defined in the source, not their manifestation in the
database. Thus it includes super-types that are not directly present in the database.</p>
</div>
<div class="section" id="general-object-layout-inside-the-database">
<h1>General Object Layout inside the Database</h1>
<p>All object types listed here map 1:1 to Java classes. Each of these classes is mapped to Eclipse's eObject system. Every
object in the database contains an attribute <span class="docutils literal">eClass</span> that uniquely identifies the type of this object. This attribute
looks like a HTTP URL but isn't: <span class="docutils literal"><span class="pre">http://{&quot;btsmodel&quot;</span> or <span class="pre">&quot;btsCorpusModel&quot;}/1.0#//{eClass</span> name}</span>.  There is two groups
of eClass definitions, called models: The <span class="docutils literal">btsmodel</span> or base model and the <span class="docutils literal">btsCorpusModel</span> (sic!) or corpus model.
The base model mainly contains internal management types. The corpus model contains types for the actual payload of the
BTS.</p>
<p>Following are two graphs that describe the relationship between all types, one for each model.</p>
<div class="figure">
<a class="reference external image-reference" href="graphs/basemodel_interface_graph.pdf"><img alt="graphs/basemodel_interface_graph.png" src="graphs/basemodel_interface_graph.png" style="width: 100%;" /></a>
<p class="caption">Graph of all interfaces of the base model. For one including the impls, see <a class="reference external" href="graphs/basemodel_type_graph.pdf">basemodel_type_graph.pdf</a>.</p>
</div>
<div class="figure">
<a class="reference external image-reference" href="graphs/corpusmodel_interface_graph.pdf"><img alt="graphs/corpusmodel_interface_graph.png" src="graphs/corpusmodel_interface_graph.png" style="width: 100%;" /></a>
<p class="caption">Graph of all interfaces of the corpus model. For one including the impls, see <a class="reference external" href="graphs/corpusmodel_type_graph.pdf">corpusmodel_type_graph.pdf</a>.</p>
</div>
<div class="section" id="tables-of-defined-eclass-values">
<h2>Tables of Defined eClass Values</h2>
<p>Following is a table per model of all defined eClasses including information on whether they are to be found in the
database.</p>
<table>
<colgroup>
<col style="width: 63%" />
<col style="width: 22%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr><th class="head"><p>eClass</p></th>
<th class="head"><p>In database <a class="footnote-reference brackets" href="#db" id="id1">1</a></p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//AdministrativDataObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSComment</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSConfig</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSConfigItem</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSConfiguration</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSDBBaseObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSDBCollectionRoleDesc</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSDBConnection</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSDate</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSExternalReference</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSIDReservationObject</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSIdentifiableItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSInterTextReference</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSNamedTypedObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSObservableObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSOperator</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSPassportEditorConfig</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSProject</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSProjectDBCollection</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSReferencableItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSRelation</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSRevision</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSTimespan</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSTranslation</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSTranslations</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSUser</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSUserGroup</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSWorkflowRule</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//BTSWorkflowRuleItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//DBLease</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//StringToStringListMap</span></span></p></td>
<td><p>✘</p></td>
<td><p><a class="footnote-reference brackets" href="#implonly" id="id2">2</a></p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//StringToStringMap</span></span></p></td>
<td><p>✘</p></td>
<td><p><a class="footnote-reference brackets" href="#implonly" id="id3">2</a></p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsmodel/1.0#//UserActionCounter</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 63%" />
<col style="width: 22%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr><th class="head"><p>eClass</p></th>
<th class="head"><p>In database <a class="footnote-reference brackets" href="#db" id="id4">1</a></p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSAbstractParagraph</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSAbstractText</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSAmbivalence</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSAmbivalenceItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSAnnotation</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSCorpusHeader</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSCorpusObject</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSGraphic</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSImage</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSLemmaCase</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSLemmaEntry</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSMarker</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSPassport</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSPassportEntry</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSPassportEntryGroup</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSPassportEntryItem</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSSenctence</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSSentenceItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSTCObject</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSText</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSTextContent</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSTextCorpus</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSTextItems</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSTextSentenceItem</span></span></p></td>
<td><p>✘</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSThsEntry</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">http://btsCorpusModel/1.0#//BTSWord</span></span></p></td>
<td><p>✔</p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="footnote brackets">
<dt class="label" id="db"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>This eClass is present only in the model, not in the database. This is the case e.g. for abstract base types.</p>
</dd>
<dt class="label" id="implonly"><span class="brackets">2</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>There is no custom implementation of this eClass. The corresponding interface uses a generic
implementation from eclipse.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="database-types">
<h1>Database types</h1>
<p>There are several different database types that are used by the BTS.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A single CouchDB instance may contain several &quot;databases&quot;, each of which may contain a whole bunch of disparate
&quot;documents&quot;.</p>
</div>
<div class="section" id="global">
<h2>Global</h2>
<p>These global databases are present exactly once and are common to all projects and corpora.</p>
<dl class="field-list simple" id="global-admin-database">
<dt><span class="docutils literal">admin</span></dt>
<dd><p>This database contains miscellaneous global data. It contains all <a class="reference internal" href="#btsproject">BTSProject</a> instances as well as the
<a class="reference internal" href="#btsuser">BTSUser</a> and <a class="reference internal" href="#btsusergroup">BTSUserGroup</a> instances used for access control.</p>
</dd>
</dl>
<dl class="field-list simple" id="global-notification-database">
<dt><span class="docutils literal">notification</span></dt>
<dd><p>This database is used for a homebrewn locking scheme. See <a class="reference internal" href="#dblease">DBLease</a>.</p>
</dd>
<dt><span class="docutils literal">users</span></dt>
<dd><p>This is a couchdb-internal database.</p>
</dd>
<dt><span class="docutils literal">replicator</span></dt>
<dd><p>This is a couchdb-internal database.</p>
</dd>
</dl>
</div>
<div class="section" id="project">
<h2>Project</h2>
<p>The project databases exist up to once per project. Sometimes, a project does not have all possible project
databases.</p>
<dl class="field-list simple" id="project-corpus-index-database">
<dt><span class="docutils literal">{project name}_corpus</span></dt>
<dd><p>This database is basically an index of all corpora that are part of this project through their respective
<a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> objects.</p>
</dd>
</dl>
<dl class="field-list simple" id="project-admin-database">
<dt><span class="docutils literal">{project name}_admin</span></dt>
<dd><p>This database contains the project's configuration, as in <a class="reference internal" href="#btsconfig">BTSConfig</a>. For some reason, it also contains all
<a class="reference internal" href="#btscomment">BTSComment</a> objects that belong to this project.</p>
</dd>
</dl>
<dl class="field-list simple" id="project-word-list-database">
<dt><span class="docutils literal">{project name}_wlist</span></dt>
<dd><p>This is the project's word list. It contains all <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> objects of this project. The texts in the
project have their words linked into this database. Objects are keyed by their ~6-digit decimal lemma keys.</p>
</dd>
</dl>
<dl class="field-list simple" id="project-thesaurus-database">
<dt><span class="docutils literal">{project name}_ths</span></dt>
<dd><p>This is the project's thesaurus database. It contains all <a class="reference internal" href="#btsthsentry">BTSThsEntry</a> objects belonging to this project.
Basically you can consider this database a project-specific grand enum table.</p>
</dd>
</dl>
<dl class="field-list simple" id="project-atext-database">
<dt><span class="docutils literal">{project name}_atext</span></dt>
<dd><p>This database type is almost entirely unused. This seems to be part of some unfinished feature.</p>
</dd>
</dl>
</div>
<div class="section" id="corpora">
<h2>Corpora</h2>
<p>The private corpus database exists once per corpus. These contain the bulk of the data in the BTS.</p>
<dl class="field-list simple" id="private-corpus-database">
<dt><span class="docutils literal">{project name}_corpus_{corpus name}</span></dt>
<dd><p>This database contains all <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> instances that belong to this project. This is mostly
<a class="reference internal" href="#btstcobject">BTSTCObject</a> and <a class="reference internal" href="#btstext">BTSText</a> instances.</p>
</dd>
</dl>
<!-- to generate data type-database statistics:
for infix in corpus.; begin echo $infix; jq -c '.docs[].eClass' *$infix*json | sort | uniq -c | sort -h; echo; end | tee typestats; end
for infix in admin.json; begin echo $infix; jq -c '.docs[].eClass' admin.json | sort | uniq -c | sort -h; echo; end | tee -a typestats; end
for infix in users replicator notification _admin wlist ths corpus_ atext; begin echo $infix; jq -c '.docs[].eClass' *$infix*.json | sort | uniq -c | sort -h; echo; end | tee -a typestats; end -->
</div>
</div>
<div class="section" id="object-types-of-the-base-model">
<h1>Object types of the base model</h1>
<div class="section" id="administrativdataobject">
<h2>AdministrativDataObject</h2>
<p>AdministrativDataObject is a base class of BTSObject meant to bring in object versioning functionality. Its fields are
the following.</p>
<dl class="field-list">
<dt><span class="docutils literal">revisions</span></dt>
<dd><p>A list of revisions of this object. In the database json, this is mapped to an array of strings. This usually looks
like this:</p>
<pre class="code literal-block"><code>[ &quot;0&#64;2015-06-26T16:13:16&#64;74cb6b70ab6b58566bfadc664b00282d&quot;,
  &quot;1&#64;2015-06-26T16:18:09&#64;74cb6b70ab6b58566bfadc664b00282d&quot;,
  &quot;2&#64;2015-08-06T10:56:12&#64;IHYWLODR3RDGHIAJRRNREH7MIQ&quot; ]</code></pre>
<p>The first element is an incrementing revision number, the second one is a timestamp in some random timezone and the
third one is the couchdb object id of the user to blame. Don't expect these to <em>always</em> actually follow that format
as <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/model/src/org/bbaw/bts/btsmodel/impl/BtsmodelFactoryImpl.java#L491">the parsing code in BtsmodelFactoryImpl.java</a> made to fail silently. There don't seem to be any inconsistencies
so far but I would not rely on that.</p>
<p>In the java domain these revisions are represented by eclipsey <a class="reference internal" href="#btsrevision">BTSRevision</a> objects.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>For accounts migrated from an older version of the BTS, the CouchDB user ID is a random string. For new accounts
it is the user's login name.</p>
</div>
<!-- ATTENTION:

Do not confuse this with CouchDB's ``_rev`` field, which is mapped by `BTSDBBaseObject`_. These two have nothing
to do with each other. In particular, the revsion counter at the beginning of this field's revision strings may
coincide with the revision counter at the beginning of couchdb's ``_rev`` field, but that is not guaranteed in
any way. Just have a look at `addRevisionStatementInternal in GenericObjectServiceImpl.java`_. -->
</dd>
</dl>
<dl class="field-list">
<dt><span class="docutils literal">state</span></dt>
<dd><p>This field is part of an improvised tombstone implementation. It may assume the values <span class="docutils literal">active</span> or <span class="docutils literal">terminated</span>.
Absence of this field seems to be considered equivalent with its value being <span class="docutils literal">active</span>.</p>
<p>The semantics of this are similar to a &quot;is_deleted&quot; field. To &quot;delete&quot; an object, you set its <span class="docutils literal">state</span> from
<span class="docutils literal">active</span> to <span class="docutils literal">terminated</span>, but leave the object in the database. This means you never delete an object's history
and an user can't mess up <em>too</em> badly.</p>
<p>This field seems to be only ever checked in a smattering of UI classes, namely <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/ui/corpus/src/org/bbaw/bts/ui/corpus/parts/CorpusNavigatorPart.java#L434">CorpusNavigatorPart.java</a>, <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/ui/corpus/src/org/bbaw/bts/ui/corpus/parts/AnnotationsPart.java#L809">AnnotationsPart.java</a>, <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/ui/egy/src/org/bbaw/bts/ui/egy/textSign/SignTextComposite.java#L1776">SignTextComposite.java</a> and <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/ui/egy/src/org/bbaw/bts/ui/egy/parts/EgyTextEditorPart.java#L2135">EgyTextEditorPart.java</a>.</p>
</dd>
</dl>
<dl class="field-list">
<dt><span class="docutils literal">revisionState</span></dt>
<dd><p>This field is also called <span class="docutils literal">reviewState</span>, it is an enum string.  The possible values of this field are enumerated
under the <span class="docutils literal"><span class="pre">Revision-Status</span></span> meta model entry.  There is a convoluted system in place to restrict which states can
be applied to which object types, however in practice luckily this remains mostly unused.</p>
<p>The meaning of this field is something along the lines of &quot;has this object been reviewed for publication?&quot;</p>
<p>This field is used in the java code in a somewhat inconsistent manner. Most object types do not have any code
referring to it even though all objects carry it. It seems the only place it <em>is</em> in fact used is with lemmata, and
there <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/corpus-services-impl/src/org/bbaw/bts/core/services/corpus/impl/services/BTSLemmaEntryServiceImpl.java#L244">the code</a> looks like this:</p>
<pre class="code literal-block"><code>entry.getRevisionState().contains(&quot;obsolete&quot;)</code></pre>
</dd>
</dl>
<dl class="field-list">
<dt><span class="docutils literal">visibility</span></dt>
<dd><p>This field is supposed to provide basic read/list access control on objects. Its possible values seem to be supposed
to be described in the <span class="docutils literal">Visibility</span> meta model entry, which contains <span class="docutils literal">group</span>, <span class="docutils literal">project</span>, <span class="docutils literal">public</span>,
<span class="docutils literal">Reader</span> and <span class="docutils literal">all_authenticated</span>. The code however contains at least one reference to one additional value
<span class="docutils literal">repository</span> in one of the obfuscated <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/couch/src/org/bbaw/bts/db/couchdb/impl/CouchDBManager.java#L98">embedded design documents in CouchDBManager.java</a>.</p>
<p>The code can't quite decide whether to check this at the database level (see the above reference) or <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/corpus-controller-impl/src/org/bbaw/bts/core/corpus/controller/impl/partController/CorpusNavigatorControllerImpl.java#L373">in the client</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="btscomment">
<h2>BTSComment</h2>
<p>A <span class="docutils literal">BTSComment</span> describes a human-language comment on some object or text section. All comments on a project are stored
in the project's <span class="docutils literal">{project name}_admin</span> database and link to their target object or text part by means of one or more
<a class="reference internal" href="#partof">partOf</a> <a class="reference internal" href="#btsrelation">BTSRelation</a> objects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btscomment">BTSComment</a> instances are stored in the <a class="reference internal" href="#project-admin-database">project admin database</a>.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Do not confuse this with <a class="reference internal" href="#btsannotation">BTSAnnotation</a>, which describes a highlighted part of a text.</p>
</div>
<p>A <span class="docutils literal">BTSComment</span> is a <a class="reference internal" href="#btsobject">BTSObject</a> and has the following fields:</p>
<dl class="field-list simple">
<dt><span class="docutils literal">comment</span></dt>
<dd><p>The comment's human-readable plain text</p>
</dd>
<dt><span class="docutils literal">tags</span></dt>
<dd><p>Unused.</p>
</dd>
</dl>
</div>
<div class="section" id="btsconfig">
<h2>BTSConfig</h2>
<p><span class="docutils literal">BTSConfig</span> is a super-type of <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> and <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a> that provides their <span class="docutils literal">children</span> attributes.</p>
<div class="section" id="config-graph">
<h3>Config Graph</h3>
<div class="figure">
<a class="reference external image-reference" href="graphs/config_graph_hybrid.pdf"><img alt="graphs/config_graph_hybrid.png" src="graphs/config_graph_hybrid.png" style="width: 100%;" /></a>
<p class="caption">Graph of the unified hierarchical structure of both <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a> instances. Each <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> is
annotated with its <span class="docutils literal">type</span> attribute.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">children</span></dt>
<dd><p>The logical children of this <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a> or <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a>. On the top levels of a <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a>
this is used to categorize according to function of the config subtree. In the passport configuration this hierarchy
is used to describe the hierarchy of passport fields and their groups. Have a look at the <a class="reference internal" href="#config-graph">Config Graph</a> for
details.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="btsconfigitem">
<h2>BTSConfigItem</h2>
<p>A <span class="docutils literal">BTSConfigItem</span> is a single node in the configuration tree rooted in a single <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a> object. A
<span class="docutils literal">BTSConfigItem</span> is a <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>, a <a class="reference internal" href="#btsconfig">BTSConfig</a> and a <a class="reference internal" href="#btsobservableobject">BTSObservableObject</a>.  Have a look at the <a class="reference internal" href="#config-graph">Config
Graph</a> to see how this is actually used.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Note that despite what it might initially seem like, <span class="docutils literal">BTSConfigItem</span> does <em>not</em> inherit from either of
<a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>, <a class="reference internal" href="#btsdbbaseobject">BTSDBBaseObject</a>, <a class="reference internal" href="#administrativdataobject">AdministrativDataObject</a> or <a class="reference internal" href="#btsobject">BTSObject</a>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">abbreviation</span></dt>
<dd><p>This field is only used with some objects with <span class="docutils literal">.type == 'objectType'</span> and contains a human-readable abbreviation
of the described type.</p>
</dd>
<dt><span class="docutils literal">description</span></dt>
<dd><p>This rarely used field is meant to contain human-readable comment on this node beyond what fits into <span class="docutils literal">label</span>. For
good measure, its contents are wrapped into an array of <a class="reference internal" href="#btstranslation">BTSTranslation</a> objects.</p>
</dd>
<dt><span class="docutils literal">ignore</span></dt>
<dd><p>This is a boolean field that can be used to &quot;comment out&quot; parts of the configuration. It seems setting this to
<span class="docutils literal">true</span> will also ignore any descendents of this node.</p>
</dd>
<dt><span class="docutils literal">label</span></dt>
<dd><p>This field is apparently meant to contain a human-readable label for the config node. It is similar to <span class="docutils literal">value</span>
<span class="docutils literal">value</span> except that the contents of <span class="docutils literal">label</span> are wrapped into an array of <a class="reference internal" href="#btstranslation">BTSTranslation</a> objects. Because why
not.</p>
</dd>
</dl>
<dl class="field-list" id="ownerreferencedtypesstringlist">
<dt><span class="docutils literal">ownerReferencedTypesStringList</span></dt>
<dd><p>This field is relevant only for a <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> describing a passport field. In this case, this field points at
an enumeration of the allowed values for the described passport field. See <a class="reference internal" href="#btspassporteditorconfig">BTSPassportEditorConfig</a>.
Example:</p>
<pre class="code literal-block"><code>[
    &quot;objectTypes.CorpusObject&gt;&gt;74cb6b70ab6b58566bfadc664b001f0c.Custom-Entries.language,&quot;,
    &quot;objectTypes.Text&gt;&gt;74cb6b70ab6b58566bfadc664b001f0c.Custom-Entries.language,&quot;,
    &quot;objectTypes.Thesaurus Entry&gt;&gt;74cb6b70ab6b58566bfadc664b001f0c.Custom-Entries.language,&quot;,
]</code></pre>
<p>This field contains a list of strings, each describing one pointer from one thing to several other things. The
format roughly is <span class="docutils literal"><span class="pre">{source}&gt;&gt;{target}[,{target}...]</span></span>. <span class="docutils literal">{source}</span> generally is one of the strings described in
<a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/global-commons/src/org/bbaw/bts/commons/BTSConstants.java#L83-L97">BASIC_OBJECT_TYPES in BTSConstants.java</a> and describes which object types this entry applies to. This means if this ORTS list is set on a passport entry config and the corresponding input widget is loaded as part of a corpus object's passport editor the tarets given in this line will be applied.</p>
<p>Each <span class="docutils literal">{target}</span> entry points either at a <a class="reference internal" href="#btsconfig">BTSConfig</a> subtree with leaf nodes being possible values or points at a
particular <span class="docutils literal">type</span> of <a class="reference internal" href="#btsthsentry">BTSThsEntry</a> objects in the global thesaurus. The input fields use this type to filter the
<a class="reference internal" href="#btsthsentry">BTSThsEntry</a> instances they display in their browsers.</p>
<p>In fact this field contains its own little borked DSL, but considering overall there are only 393 instances of it a
proper specification is hardly worth the effort. The intention can be accurately guessed in all instances. If you are so
inclined you may have look at all its nasty innards in <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/core-services-impl/src/org/bbaw/bts/core/services/impl/services/BTSConfigurationServiceImpl.java#L535">BTSConfigurationServiceImpl.java</a></p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This field is generally accessed as <span class="docutils literal">ownerTypesMap</span>. See <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/model/src/org/bbaw/bts/btsmodel/impl/BTSConfigItemImpl.java#L693-L711">fillOwnerTypesMap in BTSConfigItemImpl.java</a>.</p>
</div>
</dd>
</dl>
<dl class="field-list">
<dt><span class="docutils literal">passportEditorConfig</span></dt>
<dd><p>This field is only used for config items describing the passport structure and points to a
<a class="reference internal" href="#btspassporteditorconfig">BTSPassportEditorConfig</a> object describing the way the UI should behave for this field.</p>
</dd>
<dt><span class="docutils literal">sortKey</span></dt>
<dd><p>An integer field that in several places is used instead of <span class="docutils literal">name</span> to sort things.</p>
</dd>
<dt><span class="docutils literal">subtype</span></dt>
<dd><p>This is only used when <span class="docutils literal">.type == &quot;objectType&quot;</span> to express some sort of icon to use somewhere. The values are all
like <span class="docutils literal">IMG_SOMETHING_OR_OTHER</span>.</p>
</dd>
<dt><span class="docutils literal">type</span></dt>
<dd><p>This describes the type <em>of the config node itself</em>. One might think that this would be redundant given the
<span class="docutils literal">value</span> attribute and the hierarchical structure of the config, but come on, we're not in the <span class="docutils literal">.ini</span> days
anymore, are we? So, we end up with the following <span class="docutils literal">type</span> values:
* <span class="docutils literal">&lt;none&gt;</span>
* <span class="docutils literal"><span class="pre">Passport-Category</span></span>
* <span class="docutils literal"><span class="pre">Passport-Entry-GroupCategories</span></span>
* <span class="docutils literal"><span class="pre">Passport-Entry-Item</span> Passport</span>
* <span class="docutils literal">Relation</span>
* <span class="docutils literal">objectType</span>
* <span class="docutils literal">objectTypes</span></p>
</dd>
<dt><span class="docutils literal">value</span></dt>
<dd><p>This is the textual value of the config node. For top-level nodes this is generally the same as the Type, for
lower-level nodes this contains e.g. the type names in an enumeration or the passport field names. This field's
value is supposed to be used as an identifier, and thus generally <span class="docutils literal">looks_like_this</span>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Please do not attempt to put anything but <span class="docutils literal"><span class="pre">[a-zA-Z0-9_]</span></span> in there as the whole
<a class="reference internal" href="#ownerreferencedtypesstringlist">ownerReferencedTypesStringList</a> logic would probably break as soon as there's dots or angle brackets or
commas anywhere.</p>
</div>
</dd>
<dt><span class="docutils literal">rules</span></dt>
<dd><p>Unused.</p>
</dd>
<dt><span class="docutils literal">showWidget</span></dt>
<dd><p>Unused.</p>
</dd>
</dl>
</div>
<div class="section" id="btsconfiguration">
<h2>BTSConfiguration</h2>
<p>Every project has exactly one <span class="docutils literal">BTSConfiguration</span> stored in its <span class="docutils literal">{project name}_admin</span> database. A
<span class="docutils literal">BTSConfiguration</span> is a <a class="reference internal" href="#btsobject">BTSObject</a> and a <a class="reference internal" href="#btsconfig">BTSConfig</a>. This <span class="docutils literal">BTSConfiguration</span> describes everything and the
kitchen sink, from UI defaults through the ACL to the database schema.  The top-level <span class="docutils literal">BTSConfiguration</span> object is the
root of the config tree. Its descendants are all <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a>. They are stored in the <span class="docutils literal">children</span> attribute
inherited from <a class="reference internal" href="#btsconfig">BTSConfig</a>. Have a look at the <a class="reference internal" href="#config-graph">Config Graph</a> to see how this is actually used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsconfiguration">BTSConfiguration</a> instances are stored in the <a class="reference internal" href="#project-admin-database">project admin database</a>.</p>
</div>
<dl class="field-list">
<dt><span class="docutils literal">provider</span></dt>
<dd><p>A symbolic name of the config. This is only used to find the configuration object specified in the application
preferences. There is no reason the <span class="docutils literal">_id</span> could not be used there.</p>
<p>Following is a table of all two values this field may take.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 17%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr><th class="head"><p><span class="docutils literal">_id</span></p></th>
<th class="head"><p><span class="docutils literal">provider</span></p></th>
<th class="head"><p><span class="docutils literal">name</span></p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal">74cb6b70ab6b58566bfadc664b001f0c</span></p></td>
<td><p><span class="docutils literal">aaew</span></p></td>
<td><p>Altägyptisches Wörterbuch (AAEW)</p></td>
</tr>
<tr><td><p><span class="docutils literal">WTJMUMGNKBGYDMYAYFRNGFNBDQ</span></p></td>
<td><p><span class="docutils literal">aemconfig</span></p></td>
<td><p>AEM Configuration</p></td>
</tr>
</tbody>
</table>
<p>Generated with
<span class="docutils literal">for f in *_admin.json; jq <span class="pre">-C</span> '.docs[] | <span class="pre">select(.eClass</span> == <span class="pre">&quot;http://btsmodel/1.0#//BTSConfiguration&quot;)</span> | .name, .provider' $f; end</span></p>
</dd>
</dl>
</div>
<div class="section" id="btsdbbaseobject">
<h2>BTSDBBaseObject</h2>
<p><span class="docutils literal">BTSDBBaseObject</span> is another of those base types of just about half of everything.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">_rev</span></dt>
<dd><p>Current couchDB MVCC revision of this object. This is a string such as <span class="docutils literal"><span class="pre">1-37221aa74fd85dcb3286a87fadb9cee3</span></span>, with
the digit upfront being an incrementing (but not necessarily unique) counter and the value behind it being a
hex-encoded random value to distinguish concurrent revisions.</p>
</dd>
</dl>
<div class="section" id="access-control-fields">
<h3>Access control fields</h3>
<p>These fields are part of a half-finished implementation of a limited form of <a class="reference external" href="https://en.wikipedia.org/wiki/Access_control_list">ACLs</a>. The idea is that on a per-object
basis, a list of users or groups with read permission and a list of users or groups with update permission may be added.
There is no code to propagate permissions from parent to child objects and in the database most objects do not seem to
contain sensible ACLs.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">updaters</span></dt>
<dd><p></p></dd>
<dt><span class="docutils literal">readers</span></dt>
<dd><p>Both of these properties are lists of strings. Each entry is either a user name (which is used as the user
object's couchDB <span class="docutils literal">_id</span>) or a group name. Groups are simply implemented by their constituent users each having their
name as part of a <span class="docutils literal">groupIds</span> array in their own user object. Access is only enforced client-side, if at all.</p>
</dd>
</dl>
</div>
<div class="section" id="fields-for-local-caching-of-values">
<h3>Fields for local caching of values</h3>
<dl class="field-list simple">
<dt><span class="docutils literal">conflictingRevs</span></dt>
<dd><p>This field is a pseudo-attribute that is not written to db. Under certain circumstances it is populated by
<a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/dao-couch/src/org/bbaw/bts/dao/couchDB/CouchDBDao.java#L590">CouchDBDao.java</a> with the ids of conflicting revisions of the document containing the field as couchDB sees them.</p>
</dd>
</dl>
<dl class="field-list simple" id="dbcollectionkey">
<dt><span class="docutils literal">DBCollectionKey</span></dt>
<dd><p>Not written to db. This field is populated in <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/dao-couch/src/org/bbaw/bts/dao/couchDB/CouchDBDao.java">CouchDBDao.java</a> and caches the name of the local elasticsearch
index that contains the object this field belongs to.</p>
</dd>
</dl>
</div>
<div class="section" id="mostly-unused-fields">
<h3>(Mostly) unused fields</h3>
<dl class="field-list simple">
<dt><span class="docutils literal">locked</span></dt>
<dd><p>This field is not written to db. This is a flag that seems to be only used to change the image that is displayed for
a particular obejct.  Has no functional value.</p>
</dd>
<dt><span class="docutils literal">deleted</span></dt>
<dd><p>Not written to db. Flag; does not seem to be used anywhere</p>
</dd>
<dt><span class="docutils literal">project</span></dt>
<dd><p>Not written to db. Seems to be unused.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="btsdbcollectionroledesc">
<h2>BTSDBCollectionRoleDesc</h2>
<p>This type describes a per-project &quot;role&quot;. A role is a set of permissions such as &quot;r&quot; for a &quot;reader&quot; or &quot;rw&quot; for an
updater.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>There are two ways a user may become owner of a role. One is through <span class="docutils literal">userNames</span>, the other is through a group via
the misnamed <span class="docutils literal">userRoles</span>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">roleName</span></dt>
<dd><p>This field contains the name of the role, such as <span class="docutils literal">&quot;guests&quot;</span> or <span class="docutils literal">&quot;editors&quot;</span>.</p>
</dd>
<dt><span class="docutils literal">userNames</span></dt>
<dd><p>This field is a list of (human-readable) user names that have this role.</p>
</dd>
<dt><span class="docutils literal">userRoles</span></dt>
<dd><p>Contrary to its name, this field contains a list of couchDB ids of <a class="reference internal" href="#btsusergroup">BTSUserGroup</a> objects. All members of one of
these groups is also an owner of this role.</p>
</dd>
</dl>
</div>
<div class="section" id="btsdbconnection">
<h2>BTSDBConnection</h2>
<p>This type describes on a per-project basis where to sync to. In practice, all corpora have the same target. There are
three fields to it of which only <span class="docutils literal">masterServer</span> seems to be relevant at all.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">type</span></dt>
<dd><p>This field is either <span class="docutils literal">couchdb</span>, <span class="docutils literal">Couchdb</span> or absent. It does not seem to matter which of those.</p>
</dd>
<dt><span class="docutils literal">masterServer</span></dt>
<dd><p>This field is always the same value, It contains an HTTP URL where the couchDB is to be found.</p>
</dd>
<dt><span class="docutils literal">dbPath</span></dt>
<dd><p>Unused.</p>
</dd>
</dl>
</div>
<div class="section" id="btsdate">
<h2>BTSDate</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btsexternalreference">
<h2>BTSExternalReference</h2>
<p>A <a class="reference internal" href="#btsexternalreference">BTSExternalReference</a> describes an internal reference from one BTS object to another BTS object. This system exists
in addition to the <a class="reference internal" href="#btsrelation">BTSRelation</a> logic. Below is a table of which types use <span class="docutils literal">BTSExternalReference</span> objects in their
<span class="docutils literal">externalReferences</span> fields.</p>
<table>
<colgroup>
<col style="width: 53%" />
<col style="width: 17%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>count</p></th>
<th class="head"><p>frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a></p></td>
<td><p>63391</p></td>
<td><p>92.66%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsthsentry">BTSThsEntry</a></p></td>
<td><p>3459</p></td>
<td><p>5.06%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btstcobject">BTSTCObject</a></p></td>
<td><p>1377</p></td>
<td><p>2.01%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btstext">BTSText</a></p></td>
<td><p>111</p></td>
<td><p>0.16%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsuser">BTSUser</a></p></td>
<td><p>55</p></td>
<td><p>0.08%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsusergroup">BTSUserGroup</a></p></td>
<td><p>11</p></td>
<td><p>0.02%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsannotation">BTSAnnotation</a></p></td>
<td><p>3</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a></p></td>
<td><p>2</p></td>
<td><p>0.00%</p></td>
</tr>
</tbody>
</table>
<dl class="field-list">
<dt><span class="docutils literal">type</span></dt>
<dd><p>The <span class="docutils literal">type</span> of an external reference describes roughly the target domain of the reference. The most common <span class="docutils literal">type</span>
is <span class="docutils literal">aaew_wcn</span> which stands for <span class="docutils literal">Altägyptisches Wörterbuch: Wortcorpusnummer</span>. This is simply the index number
(and thus in this database couchdb object id) of the target entry. <span class="docutils literal">aaew_1</span> are references to row IDs in an older
version of the AÄW. Note that anything besides these two is perfectly irrelevant in practice.</p>
<table>
<colgroup>
<col style="width: 36%" />
<col style="width: 23%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr><th class="head"><p>type</p></th>
<th class="head"><p>count</p></th>
<th class="head"><p>frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>aaew_wcn</p></td>
<td><p>63391</p></td>
<td><p>92.66%</p></td>
</tr>
<tr><td><p>aaew_1</p></td>
<td><p>3525</p></td>
<td><p>5.15%</p></td>
</tr>
<tr><td><p>&lt;none&gt;</p></td>
<td><p>1487</p></td>
<td><p>2.17%</p></td>
</tr>
<tr><td><p>URI</p></td>
<td><p>2</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>text</p></td>
<td><p>2</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>Text</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>geo</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><span class="docutils literal">reference</span></dt>
<dd><p>This is the actual text of the reference. Generally, this is the target object's database ID.</p>
</dd>
<dt><span class="docutils literal">provider</span></dt>
<dd><p>This is redundant to <span class="docutils literal">type</span> to describe what kind of thing this reference describes. The valid values of the field
are enumerated in the meta model.</p>
</dd>
</dl>
</div>
<div class="section" id="btsidreservationobject">
<h2>BTSIDReservationObject</h2>
<p><span class="docutils literal">BTSIDReservationObject</span> is meant to allow an user to pre-commit an object ID. Since in some cases the objects couchDB
id is actually the lemma number this is actually mission-critical and collisions would actually produce a lot of
problems. The logic surrounding this is quite brittle and lacks proper error handling or locking.</p>
<p>A single <span class="docutils literal">BTSIDReservationObject</span> represents a reservation of a single ID. The application always tries to keep a
fixed number of reservations in cache. If the application can't find a reservation, it will just make up an ID in a
totally different format (mangled UUID) instead.</p>
<p>Since in different places different ID formats are used (see <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>), <span class="docutils literal">BTSIDReservationObject</span> allows
prefixes. There is no further scoping or proper namespacing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsidreservationobject">BTSIDReservationObject</a> instances are stored in the <a class="reference internal" href="#project-word-list-database">project word list database</a>.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>The details of the reservation logic are controlled by the <span class="docutils literal">propertyStrings</span> field on the
<a class="reference internal" href="#btsprojectdbcollection">BTSProjectDBCollection</a> belonging to the active (dictionary) object.</p>
</div>
<p><span class="docutils literal">BTSIDReservationObject</span> is a subtype of <a class="reference internal" href="#btsdbbaseobject">BTSDBBaseObject</a>. From there it inherits its useless <cite>_rev</cite> field.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">_id</span></dt>
<dd><p>This is the actual ID being reserved. This is a couchDB id, but it also carries a semantic value. This is always
something human-readable, some arbitrary prefix (generally <span class="docutils literal">&quot;&quot;</span> or <span class="docutils literal">&quot;d&quot;</span>) followed by a 4-6 digit number.</p>
</dd>
<dt><span class="docutils literal">updaters</span></dt>
<dd><p>This field has a totally different meaning than elsewhere, though I suspect that that might only be the java side
and the javascript view functions might not actually care. Here, this is always an array of one element, which
always is the ID (which is also sometimes the human-readable name) of the user that created this reservation.</p>
</dd>
<dt><span class="docutils literal">btsUUID</span></dt>
<dd><p>This is an ID meant to identify a single BTS installation. It is set to a string of the decimal timestamp
of the first time that BTS installation was started. Example: <span class="docutils literal">&quot;1447396852251&quot;</span>.  Be careful in that generally
within the BTS the name &quot;uuid&quot; does not always refer to what is commonly known as an <a class="reference external" href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a>. In fact, it may
neither be guaranteed to be universal nor unique as you can see in one case in <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/controller-impl/src/org/bbaw/bts/core/controller/impl/generalController/ApplicationStartupControllerImpl.java#L162">applicationStartup in
ApplicationStartupControllerImpl.java</a>.  Also, have a look at <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/core-services-impl/src/org/bbaw/bts/core/services/impl/services/IDServiceImpl.java#L68">createId in IDServiceImpl.java</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="btsidentifiableitem">
<h2>BTSIdentifiableItem</h2>
<p><span class="docutils literal">BTSIdentifiableItem</span> is a base interface of most everything in the database. Its purpose is to describe anything that
holds an <span class="docutils literal">_id</span> attribute, which in couchdb is every top-level document (i.e. that is not embedded into some other
document). Its sole field is:</p>
<dl class="field-list">
<dt><span class="docutils literal">_id</span></dt>
<dd><p>The raw couchdb object ID. Do not make any assumptions about the contents of this field. Treat it as couchdb treats
it: As an arbitrary string. Fun fact: There is both an object with the <span class="docutils literal">_id</span> <span class="docutils literal"><span class="pre">-1</span></span> and one with the <span class="docutils literal">_id</span>
<span class="docutils literal"><span class="pre">-2</span></span>, among other oddities.</p>
<p>Using the following code we can get some statistics about these ids.</p>
<pre class="code literal-block"><code>set count (wc -l ids|cut -d' ' -f1); for re in '^&quot;[0-9]+&quot;$' '^&quot;[0-9a-f]{32}&quot;$' '^&quot;[a-zA-Z0-9]{27}&quot;$' '^&quot;[A-Z0-9]{26}&quot;$' '^&quot;dm?[0-9]*&quot;$'; set num (egrep $re ids|wc -l); echo $re $num (echo $num/$count|bc -l); end</code></pre>
<p>The total number of objects is slightly over 4.4 million.</p>
<table>
<colgroup>
<col style="width: 53%" />
<col style="width: 19%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr><th class="head"><p>regex</p></th>
<th class="head"><p>count</p></th>
<th class="head"><p>percentage</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal"><span class="pre">[a-zA-Z0-9]{27}</span></span></p></td>
<td><p>4282726</p></td>
<td><p>96.86%</p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">[A-Z0-9]{26}</span></span></p></td>
<td><p>70761</p></td>
<td><p>1.60%</p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">[0-9]+</span></span></p></td>
<td><p>52185</p></td>
<td><p>1.18%</p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">dm[0-9]*</span></span></p></td>
<td><p>15070</p></td>
<td><p>0.34%</p></td>
</tr>
<tr><td><p><span class="docutils literal"><span class="pre">[0-9a-f]{32}</span></span></p></td>
<td><p>3</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>other</p></td>
<td><p>833</p></td>
<td><p>0.02%</p></td>
</tr>
</tbody>
</table>
<p>For some database objects inherited from previous BTS versions, short numeric strings such as <span class="docutils literal">100120</span> are used.</p>
</dd>
</dl>
</div>
<div class="section" id="btsintertextreference">
<h2>BTSInterTextReference</h2>
<p><span class="docutils literal">beginId</span> and <span class="docutils literal">endId</span> may be set. If that is the case, the target is a
range of the content of a <span class="docutils literal">BTSText</span> and <span class="docutils literal">beginId</span> and <span class="docutils literal">endId</span> both refer to objects such as <a class="reference internal" href="#btsword">BTSWord</a>.</p>
<p>Following is an exhaustive table of the object types <span class="docutils literal">beginId</span> and <span class="docutils literal">endId</span> refer to in the live data.</p>
<table>
<colgroup>
<col style="width: 53%" />
<col style="width: 19%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><a class="reference internal" href="#btsword">BTSWord</a></p></td>
<td><p>44727</p></td>
<td><p>72.2%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsmarker">BTSMarker</a></p></td>
<td><p>17212</p></td>
<td><p>27.8%</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsambivalence">BTSAmbivalence</a></p></td>
<td><p>10</p></td>
<td><p>0.0%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="btsnamedtypedobject">
<h2>BTSNamedTypedObject</h2>
<p>BTSNamedTypedObject is an interface that through <span class="docutils literal">BTSObject</span> and other inheritance paths is implemented by a large
number of types. It describes an object that may have a <span class="docutils literal">name</span>, a <span class="docutils literal">type</span>, a <span class="docutils literal">subtype</span> and a <span class="docutils literal">sortKey</span>. <span class="docutils literal">type</span>
and <span class="docutils literal">subtype</span> are used somewhat inconsistently. For some object types, their range of values is described in the meta
model entries under <span class="docutils literal">/objectTypes</span>. Not every object type uses <span class="docutils literal">type</span> as well as <span class="docutils literal">subtype</span> and not every <span class="docutils literal">type</span>
also has one or more <span class="docutils literal">subtype</span>.</p>
<dl class="field-list">
<dt><span class="docutils literal">name</span></dt>
<dd><p>This field generally describes a human-readable name of the object. The <span class="docutils literal">name</span> is generally used as a label when
displaying objects (e.g. in the tree viewer, or in an input mask). Sample values for this are e.g. <span class="docutils literal">Hammamat <span class="pre">C-M</span> 265</span>
and <span class="docutils literal">〈Wadi Allaqi 3〉</span> for some TCObjects or <span class="docutils literal">ḫnd (ḥr) (mw)</span> and <span class="docutils literal"><span class="pre">mꜣꜣ.t-Ḥr.w</span></span> for some lemmata.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>In case of lemmata the name often is a simple concatenation of transliterations of the lemma's constituent
words, but <strong>this is no rule</strong>.</p>
</div>
</dd>
<dt><span class="docutils literal">type</span></dt>
<dd><p>This field describes the logical type of the object. Its semantics vary by object type/eclass. Following are some
example values found in the live database.</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>List of possible of values in JSON</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal">Corpus:Text</span></p></td>
<td><p><span class="docutils literal">&quot;Text&quot;, &quot;Subtext&quot;, &quot;subtext&quot;, &quot;undefined&quot;, &quot;&quot;, null</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:Senctence</span></p></td>
<td><p><span class="docutils literal">&quot;HS&quot;, null</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Base:Comment</span></p></td>
<td><p>No type, no subtype.</p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:LemmaEntry</span></p></td>
<td><p><span class="docutils literal">null, &quot;undefined&quot;, &quot;numeral&quot;, &quot;particle&quot;, &quot;preposition&quot;, &quot;verb&quot;, ... ~15</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:Annotation</span></p></td>
<td><p><span class="docutils literal">&quot;undefined&quot;, null, &quot;conceptual&quot; &quot;ConceptualGroup2&quot;, <span class="pre">&quot;Annotation-Leipzig&quot;,</span> ... ~10</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:TCObject</span></p></td>
<td><p><span class="docutils literal">null, &quot;&quot;, &quot;undefined&quot;, &quot;Arrangement&quot;, &quot;TCSuperText&quot;, &quot;TCObject&quot;, &quot;Group&quot;, &quot;Scene&quot;, ... ~10</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:TextCorpus</span></p></td>
<td><p><span class="docutils literal">null, &quot;undefined&quot;</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:ThsEntry</span></p></td>
<td><p><span class="docutils literal">null, &quot;objectType&quot;, &quot;objecttype&quot;, &quot;actor&quot;, &quot;grouping&quot;, &quot;miniature&quot;, &quot;model&quot;, &quot;material&quot;, &quot;copy&quot;, ... ~25</span></p></td>
</tr>
</tbody>
</table>
<p><span class="docutils literal">BTSMarker</span> is a <span class="docutils literal">BTSNamedTypedObject</span>, but its type field seems to be free text provided by the user.</p>
</dd>
<dt><span class="docutils literal">subtype</span></dt>
<dd><p>This field is sometimes used to describe a subtype of an object. It is used only in the following object types:</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>List of possible of values in JSON</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><span class="docutils literal">Base:ConfigItem</span></p></td>
<td><p><span class="docutils literal">&quot;IMG_THS&quot;, &quot;IMG_ANNOTATION&quot;, &quot;IMG_OVR_OBSOLETE&quot;, ... ~30</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:LemmaEntry</span></p></td>
<td><p><span class="docutils literal">&quot;person_name&quot;, &quot;substantive_masc&quot;, &quot;gods_name&quot;, &quot;title&quot;, <span class="pre">&quot;verb_2-lit&quot;,</span> ... ~50</span></p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:Annotation</span></p></td>
<td><p><span class="docutils literal">&quot;MetaphorRelatedWord&quot;, &quot;Metonym&quot;, &quot;subtype&quot;, <span class="pre">&quot;left-to-right&quot;,</span> ... ~10</span>. Only used very infrequently.</p></td>
</tr>
<tr><td><p><span class="docutils literal">Corpus:TCObject</span></p></td>
<td><p>Only four overall usages, with values <span class="docutils literal">&quot;undefined&quot;</span> (thrice) and <span class="docutils literal">&quot;subcaption&quot;</span> (once)</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><span class="docutils literal">sortKey</span></dt>
<dd><p>An integer field that in several places is used instead of <span class="docutils literal">name</span> to sort things. Following is an exhaustive table
of occurences.</p>
<table>
<colgroup>
<col style="width: 54%" />
<col style="width: 20%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Corpus:Text</p></td>
<td><p>14196</p></td>
<td><p>46.38%</p></td>
</tr>
<tr><td><p>Corpus:TCObject</p></td>
<td><p>1403</p></td>
<td><p>8.76%</p></td>
</tr>
<tr><td><p>Corpus:ThsEntry</p></td>
<td><p>4</p></td>
<td><p>0.115%</p></td>
</tr>
<tr><td><p>Corpus:Annotation</p></td>
<td><p>2</p></td>
<td><p>0.014%</p></td>
</tr>
<tr><td><p>Corpus:TextCorpus</p></td>
<td><p>1</p></td>
<td><p>2.00%</p></td>
</tr>
<tr><td><p>Base:ConfigItem</p></td>
<td><p>297</p></td>
<td><p>36.89%</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="btsobject">
<h2>BTSObject</h2>
<p>Base type for a large part of database objects. Brings in <span class="docutils literal">_id, name, type, subtype, sortKey</span> by means of inheritance
from <span class="docutils literal">BTSNamedTypedObject</span> and in turn <span class="docutils literal">BTSIdentifiableItem</span>. Also brings in <span class="docutils literal">revisions, state, revisionState, visibility</span> from AdministrativDataObject.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Despite its name only about half of the database object types inherit from this. Also, do not trust even the meager
amounts of documentation in its source code.</p>
</div>
<p>The model for BTSObject includes a field <span class="docutils literal">tempSortKey</span> that is used in some places, but this field never makes it to
the database. It is instead used as some kind of object-global variable.</p>
<dl class="field-list">
<dt><span class="docutils literal">code</span></dt>
<dd><p>Never used.</p>
</dd>
<dt><span class="docutils literal">relations</span></dt>
<dd><p>Array field of <span class="docutils literal">Relation</span> objects describing relations between the containing object and other objects. This is
used to describe complex relations such as <span class="docutils literal">rootOf</span> or <span class="docutils literal">composedOf</span> for lemmata. <em>Everywhere</em> else it is only
ever used with <a class="reference internal" href="#partof">partOf</a> to express the hierarchical structure of the object tree. Below is an exhaustive table of
occurences.</p>
<table>
<colgroup>
<col style="width: 54%" />
<col style="width: 20%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Corpus:Annotation</p></td>
<td><p>13862</p></td>
<td><p>100%</p></td>
</tr>
<tr><td><p>Corpus:TCObject</p></td>
<td><p>16008</p></td>
<td><p>100%</p></td>
</tr>
<tr><td><p>Corpus:Text</p></td>
<td><p>30605</p></td>
<td><p>99.99%</p></td>
</tr>
<tr><td><p>Base:Comment</p></td>
<td><p>33312</p></td>
<td><p>99.99%</p></td>
</tr>
<tr><td><p>Corpus:ThsEntry</p></td>
<td><p>3457</p></td>
<td><p>99.34%</p></td>
</tr>
<tr><td><p>Corpus:LemmaEntry</p></td>
<td><p>20195</p></td>
<td><p>30.11%!</p></td>
</tr>
<tr><td><p>Corpus:TextCorpus</p></td>
<td><p>1</p></td>
<td><p>2%</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><span class="docutils literal">externalReferences</span></dt>
<dd><p>This field is an array of <span class="docutils literal">ExternalReference</span> objects. The idea here seems to be to store alternative ways to
refer to the entry containing the field. In practice, it only used a handful (&lt;50) times outside the dictionary
proper with the notable exception of the TLA demotic corpus. In the TLA demotic corpus it is used to store malformed
URLs pointing to an external database. In the dictionary it is used to store reference numbers of the entries. In
the user database it is used to store what seems to be user IDs of a previous BTS version.</p>
<p>Below is a listing of occurrences by object type in the database.</p>
<table>
<colgroup>
<col style="width: 54%" />
<col style="width: 20%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>Corpus:LemmaEntry</p></td>
<td><p>63391</p></td>
<td><p>94.52%</p></td>
</tr>
<tr><td><p>Corpus:ThsEntry</p></td>
<td><p>3459</p></td>
<td><p>99.40%</p></td>
</tr>
<tr><td><p>Base:User</p></td>
<td><p>55</p></td>
<td><p>47%</p></td>
</tr>
<tr><td><p>Corpus:TCObject</p></td>
<td><p>1370</p></td>
<td><p>8.56%</p></td>
</tr>
<tr><td><p>Corpus:Text</p></td>
<td><p>109</p></td>
<td><p>0.36%</p></td>
</tr>
<tr><td><p>Base:UserGroup</p></td>
<td><p>11</p></td>
<td><p>0.45%</p></td>
</tr>
<tr><td><p>Corpus:Annotation</p></td>
<td><p>3</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>Corpus:TextCorpus</p></td>
<td><p>1</p></td>
<td><p>2%</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="btsobservableobject">
<h2>BTSObservableObject</h2>
<p>BTSObservableObject is purely internal. It extends EObject and adds an interface for third parties to track
modifications of this object's eclipsey properties.</p>
</div>
<div class="section" id="btsoperator">
<h2>BTSOperator</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btspassporteditorconfig">
<h2>BTSPassportEditorConfig</h2>
<p>This is a rather hairy one. An instance of this type describes
<span class="docutils literal">BTSPassportEditorConfig</span> is a subtype of <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<dl class="field-list">
<dt><span class="docutils literal">widgetType</span></dt>
<dd><p>This indicates what type of input field is desired. These widget types are the following:</p>
<pre class="code literal-block"><code>jq -c '.docs[] | recurse(.children[]?) | .passportEditorConfig? | select(. != null) | .widgetType' aem_admin.json aaew_admin.json | sort | uniq -c | sort -rn</code></pre>
<table>
<colgroup>
<col style="width: 54%" />
<col style="width: 18%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr><th class="head"><p><span class="docutils literal">widgetType</span></p></th>
<th class="head"><p><span class="docutils literal">count</span></p></th>
<th class="head"><p><span class="docutils literal">percentage</span></p></th>
</tr>
</thead>
<tbody>
<tr><td><p>null</p></td>
<td><p>558</p></td>
<td><p>69%</p></td>
</tr>
<tr><td><p>&quot;Text&quot;</p></td>
<td><p>81</p></td>
<td><p>10%</p></td>
</tr>
<tr><td><p>&quot;Boolean Select&quot;</p></td>
<td><p>62</p></td>
<td><p>8%</p></td>
</tr>
<tr><td><p>&quot;Text Field&quot;</p></td>
<td><p>46</p></td>
<td><p>6%</p></td>
</tr>
<tr><td><p>&quot;Select from Thesaurus&quot;</p></td>
<td><p>32</p></td>
<td><p>4%</p></td>
</tr>
<tr><td><p>&quot;Select from Configuration&quot;</p></td>
<td><p>26</p></td>
<td><p>3%</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt><span class="docutils literal">Text</span></dt>
<dd><p>is a single-line text field.</p>
</dd>
<dt><span class="docutils literal">Text Field</span></dt>
<dd><p>is a multi-line text field</p>
</dd>
<dt><span class="docutils literal">Boolean Select</span></dt>
<dd><p>is a simple checkbox</p>
</dd>
</dl>
<dl class="field-list" id="select-from-thesaurus">
<dt><span class="docutils literal">Select from Thesaurus</span></dt>
<dd><p>This results in a text field and a button. Usage is a bit different to regular text
fields. You can directly input an object's ID or name here, but you have to press a key combination to &quot;resolve&quot;
this into a proper reference to the object via the autocompletion. If this is not done, the input value is not
persisted.</p>
<p>Next to this weird text field is two buttons that are actually labels. One opens an object browser on the
currently referenced object. The other opens another object browser, but one that only displays objects matched
by <a class="reference internal" href="#ownerreferencedtypesstringlist">ownerReferencedTypesStringList</a>.</p>
</dd>
<dt><span class="docutils literal">Select from Configuration</span></dt>
<dd><p>This results in a drop-down list containing entries that are themselves read from
&quot;the configuration&quot;. The values this drop-down list allows are pointed at in the
<a class="reference internal" href="#ownerreferencedtypesstringlist">ownerReferencedTypesStringList</a> field of <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a>.</p>
</dd>
</dl>
<p>The <span class="docutils literal">null</span> values are there since many <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> instances that don't actually need a
<span class="docutils literal">BTSPassportEditorConfig</span> for some reason still have an empty one.</p>
</dd>
<dt><span class="docutils literal">horizontalWidth</span></dt>
<dd><p>This sets the width of this input field in the UI as a number of layout grid cells. This has nothing to do with the
data contained within the field which still may be of arbitrary length.</p>
</dd>
<dt><span class="docutils literal">allowMultiple</span></dt>
<dd><p>This indicates whether this entry may hold a list of values instead of a single value. In the UI this is solved
using the &quot;add row&quot; input field pattern.</p>
</dd>
<dt><span class="docutils literal">required</span></dt>
<dd><p>This is never used in practice. The idea is that when this is set, the corresponding passport entry must be set
before submitting changes.</p>
</dd>
<dt><span class="docutils literal">regex</span></dt>
<dd><p>This is never used in practice. The idea is that when this is set, the corresponding passport entry must conform to
this regex before submitting changes.</p>
</dd>
<dt><span class="docutils literal">predicateList</span></dt>
<dd><p>This is never used in practice. No idea what the idea was with this.</p>
</dd>
</dl>
</div>
<div class="section" id="btsproject">
<h2>BTSProject</h2>
<p>A &quot;Project&quot; is a single administrative entity. It has its own database configuration, access control rules and set of
corpora. <span class="docutils literal">BTSProject</span> is a subtype of <a class="reference internal" href="#btsobject">BTSObject</a>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>There is no direct link between a <span class="docutils literal">BTSProject</span> and its constituent <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> instances.</p>
<p>Both are only linked through the <span class="docutils literal">corpusPrefix</span> field in <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> pointing at one of the
<a class="reference internal" href="#btsprojectdbcollection">BTSProjectDBCollection</a> instances of the <a class="reference internal" href="#btsproject">BTSProject</a>. Every time the <span class="docutils literal">BTSProject</span> side of the database has to
be accessed from the <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> side, the <a class="reference internal" href="#btsproject">BTSProject</a>/<a class="reference internal" href="#btsprojectdbcollection">BTSProjectDBCollection</a>/whatever is simply looked
up by <span class="docutils literal">corpusPrefix</span>. A good starting point for looking into this is <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/controller-impl/src/org/bbaw/bts/core/controller/impl/generalController/PermissionsAndExpressionsEvaluationControllerImpl.java#L691-L704">getDBCollection in
PermissionsAndExpressionsEvaluationControllerImpl.java</a>.</p>
</div>
<p>The BTSProject is not exposed much in the user interface. The main contact area with this type is the installer, where
one can select one or multiple projects to download.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsproject">BTSProject</a> instances are stored in the <a class="reference internal" href="#global-admin-database">global admin database</a>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">prefix</span></dt>
<dd><p>&quot;key&quot; of this project, such as <span class="docutils literal">&quot;aaew&quot;</span> in case of the Altägyptisches Wörterbuch. Among others, this is used in
the database name of this project's personal database.</p>
</dd>
<dt><span class="docutils literal">name</span></dt>
<dd><p>Inherited from <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a> via <a class="reference internal" href="#btsobject">BTSObject</a> this contains the project's human-readable name, such as
<span class="docutils literal">&quot;Altägyptisches Wörterbuch BBAW&quot;</span>.</p>
</dd>
<dt><span class="docutils literal">description</span></dt>
<dd><p>Does not contain much if anything at all, such as &quot;Höhlenbuch (Unterweltsbuch)&quot; for the &quot;Höhlenbuch&quot;.</p>
</dd>
<dt><span class="docutils literal">dbConnection</span></dt>
<dd><p><a class="reference internal" href="#btsdbconnection">BTSDBConnection</a> of this project. This describes which database this project is supposed to sync to.</p>
</dd>
<dt><span class="docutils literal">dbCollections</span></dt>
<dd><p>This field contains a list of <a class="reference internal" href="#btsprojectdbcollection">BTSProjectDBCollection</a> objects. Though from the code it seems higher ambitions were
had there is always exactly one database collection per text corpus.</p>
</dd>
</dl>
</div>
<div class="section" id="btsprojectdbcollection">
<h2>BTSProjectDBCollection</h2>
<p>A <span class="docutils literal">BTSProjectDBCollection</span> describes one couchDB database belonging to the project. This database contains the objects
of a single <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a>.  <span class="docutils literal">BTSProjectDBCollection</span> is a subtype of <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">collectionName</span></dt>
<dd><p>The name of the couchDB database, such as <span class="docutils literal">aaew_corpus_bbawfelsinschriften</span>.</p>
</dd>
<dt><span class="docutils literal">propertyStrings</span></dt>
<dd><p>This field contains a (json) list of <span class="docutils literal">&quot;key=value&quot;</span> (json) strings. In practice, these are solely used on the
dictionaries to configure the ID reservation logic.</p>
</dd>
<dt><span class="docutils literal">roleDescriptions</span></dt>
<dd><p></p></dd>
<dt><span class="docutils literal">indexed</span></dt>
<dd><p>This boolean flag sets whether this database is supposed to be indexed by elasticsearch. See <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/db/couch/src/org/bbaw/bts/db/couchdb/impl/CouchDBManager.java">CouchDBManager.java</a>
for details.</p>
</dd>
<dt><span class="docutils literal">synchronized</span></dt>
<dd><p>This boolean flag sets whether this database is supposed to be synchronized to remote described in this
<a class="reference internal" href="#btsprojectdbcollection">BTSProjectDBCollection</a>'s owner <a class="reference internal" href="#btsproject">BTSProject</a>'s <a class="reference internal" href="#btsdbconnection">BTSDBConnection</a>.</p>
</dd>
</dl>
</div>
<div class="section" id="btsreferencableitem">
<h2>BTSReferencableItem</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btsrelation">
<h2>BTSRelation</h2>
<p>Though CouchDB is a document-oriented database and lends itself quite well to tree- or graph-structured data, this is
not how it is used in BTS. Instead, the tree-like structure of objects is represented with an ersatz relational layer
made up of <a class="reference internal" href="#btsrelation">BTSRelation</a> objects.</p>
<p>A <span class="docutils literal">BTSRelation</span> represents a single item in a relation (and not as the name implies the relation itself). An
implementation detail is that these relations are inherently directional, and the <span class="docutils literal">BTSRelation</span> object is always
stored in the <em>head</em> object. So, a <a class="reference internal" href="#partof">partOf</a> relation describing that object <span class="docutils literal">A</span> is a part of object <span class="docutils literal">B</span> would be
stored in object <span class="docutils literal">A</span>. Read: <span class="docutils literal">A is partOf B</span>.</p>
<p>Every relation contains the couchDB <span class="docutils literal">_id</span> of its target object in its <span class="docutils literal">objectId</span> field.</p>
<p>Relations come in many flavors. The important one is <a class="reference internal" href="#partof">partOf</a>, which is used to express hierarchical structure in the
object browser. It can be used on most anything. The other relation type flavors are only used on <span class="docutils literal">BTSLemmaEntry</span>
objects. Below are some nice stats on these.</p>
<p>Due to the inherently asymmetric nature of this representation, most &quot;relation types&quot; need a reciprocal type to be put
at the far end of the relation. Such pairs are e.g. <span class="docutils literal">successor</span> and <span class="docutils literal">predecessor</span> or <span class="docutils literal">composes</span> and
<span class="docutils literal">composedOf</span>. Note that these are sometimes not named very well.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p><a class="reference internal" href="#partof">partOf</a> relations do not have a reciprocal element.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>reciprocal relations are maintained by hand, this does in practice lead to inconsistencies as are evident
for example from the untyped relations shown in the data below.</p>
</div>
<div class="section" id="relation-type-statistics">
<h3>Relation type statistics</h3>
<pre>Type <font color="#cc3333">CorpusModel:Annotation</font>
      13864 <font color="#cc6633">partOf</font>

Type <font color="#3399cc">CorpusModel:LemmaEntry</font>
      10809 <font color="#3333cc">rootOf</font>
       7028 <font color="#6633cc">referencing</font>
       6999 <font color="#33cccc">referencedBy</font>
       3877 <font color="#6633cc">successor</font>
       3765 <font color="#cc33cc">predecessor</font>
       3278 <font color="#33cc33">composedOf</font>
       3278 <font color="#cc3333">composes</font>
       1812 <font color="#cc6633">partOf</font>
       1729 <font color="#cc3399">contains</font>
          4 <font color="#3399cc">&lt;none&gt;</font>

Type <font color="#33cc99">CorpusModel:TCObject</font>
      16029 <font color="#cc6633">partOf</font>
          1 <font color="#3399cc">&lt;none&gt;</font>

Type <font color="#3333cc">CorpusModel:Text</font>
      30641 <font color="#cc6633">partOf</font>
          2 <font color="#3399cc">&lt;none&gt;</font>

Type <font color="#cc3366">CorpusModel:TextCorpus</font>
          1 <font color="#3399cc">&lt;none&gt;</font>

Type <font color="#cc3366">CorpusModel:ThsEntry</font>
       3452 <font color="#cc6633">partOf</font>
          5 <font color="#33cc33">owner</font>

Type <font color="#cc3333">model:Comment</font>
      33314 <font color="#cc6633">partOf</font></pre>
</div>
<div class="section" id="relation-target-type-statistics">
<h3>Relation target type statistics</h3>
<pre>Type <font color="#cc3333">CorpusModel:Annotation</font>
       13830 <font color="#cc6633">partOf</font>(<font color="#3333cc">CorpusModel:Text</font>)
          15 <font color="#cc6633">partOf</font>(<font color="#3333cc">None</font>)
           8 <font color="#cc6633">partOf</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
           5 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:TextCorpus</font>)
           4 <font color="#cc6633">partOf</font>(<font color="#33cc99">CorpusModel:TCObject</font>)
           1 <font color="#cc6633">partOf</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           1 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:ThsEntry</font>)
 
Type <font color="#3399cc">CorpusModel:LemmaEntry</font>
       10808 <font color="#3333cc">rootOf</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        7028 <font color="#6633cc">referencing</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        6992 <font color="#33cccc">referencedBy</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        3768 <font color="#6633cc">successor</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        3765 <font color="#cc33cc">predecessor</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        3278 <font color="#33cc33">composedOf</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        3278 <font color="#cc3333">composes</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        1810 <font color="#cc6633">partOf</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
        1729 <font color="#cc3399">contains</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
         109 <font color="#6633cc">successor</font>(<font color="#3333cc">None</font>)
           6 <font color="#33cccc">referencedBy</font>(<font color="#3333cc">None</font>)
           4 <font color="#3399cc">&lt;none&gt;</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           2 <font color="#cc6633">partOf</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           1 <font color="#33cccc">referencedBy</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           1 <font color="#3333cc">rootOf</font>(<font color="#6633cc">&lt;parts&gt;</font>)
 
 Type <font color="#33cc99">CorpusModel:TCObject</font>
       15843 <font color="#cc6633">partOf</font>(<font color="#33cc99">CorpusModel:TCObject</font>)
         169 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:TextCorpus</font>)
          16 <font color="#cc6633">partOf</font>(<font color="#3333cc">CorpusModel:Text</font>)
           1 <font color="#3399cc">&lt;none&gt;</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           1 <font color="#cc6633">partOf</font>(<font color="#6633cc">&lt;parts&gt;</font>)
 
 Type <font color="#3333cc">CorpusModel:Text</font>
       26586 <font color="#cc6633">partOf</font>(<font color="#33cc99">CorpusModel:TCObject</font>)
        4007 <font color="#cc6633">partOf</font>(<font color="#3333cc">CorpusModel:Text</font>)
          46 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:TextCorpus</font>)
           2 <font color="#3399cc">&lt;none&gt;</font>(<font color="#6633cc">&lt;parts&gt;</font>)
           2 <font color="#cc6633">partOf</font>(<font color="#6633cc">&lt;parts&gt;</font>)
 
 Type <font color="#cc3366">CorpusModel:TextCorpus</font>
           1 <font color="#3399cc">&lt;none&gt;</font>(<font color="#6633cc">&lt;parts&gt;</font>)
 
 Type <font color="#cc3366">CorpusModel:ThsEntry</font>
        3441 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:ThsEntry</font>)
          11 <font color="#cc6633">partOf</font>(<font color="#3333cc">None</font>)
           5 <font color="#33cc33">owner</font>(<font color="#3333cc">None</font>)
 
 Type <font color="#cc3333">model:Comment</font>
       33295 <font color="#cc6633">partOf</font>(<font color="#3333cc">CorpusModel:Text</font>)
           8 <font color="#cc6633">partOf</font>(<font color="#3333cc">None</font>)
           6 <font color="#cc6633">partOf</font>(<font color="#33cc99">CorpusModel:TCObject</font>)
           3 <font color="#cc6633">partOf</font>(<font color="#3399cc">CorpusModel:LemmaEntry</font>)
           1 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:TextCorpus</font>)
           1 <font color="#cc6633">partOf</font>(<font color="#cc3366">CorpusModel:ThsEntry</font>)</pre>
</div>
<div class="section" id="partof-relations">
<span id="partof"></span><h3>PartOf relations</h3>
<p>In certain cases such as when used with a <a class="reference internal" href="#btscomment">BTSComment</a> a <a class="reference internal" href="#partof">partOf</a> relation may contain <span class="docutils literal">parts</span>. Each &quot;part&quot; is a
<a class="reference internal" href="#btsintertextreference">BTSInterTextReference</a> pointing to part of some text. The statistics of the number of parts of a single relation as
extracted from a database backup are as follows.</p>
<p><span class="docutils literal">jq <span class="pre">'.docs[].relations[]?.parts</span> | length' *.json | sort | uniq <span class="pre">-c</span> | sort <span class="pre">-bnk2</span></span></p>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 29%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr><th class="head"><p>length</p></th>
<th class="head"><p>count</p></th>
<th class="head"><p>percentage</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>0</p></td>
<td><p>92685</p></td>
<td><p>66.26</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>46892</p></td>
<td><p>33.52</p></td>
</tr>
<tr><td><p>2</p></td>
<td><p>206</p></td>
<td><p>0.15</p></td>
</tr>
<tr><td><p>3</p></td>
<td><p>53</p></td>
<td><p>0.04</p></td>
</tr>
<tr><td><p>4</p></td>
<td><p>28</p></td>
<td><p>0.02</p></td>
</tr>
<tr><td><p>5</p></td>
<td><p>11</p></td>
<td><p>0.01</p></td>
</tr>
<tr><td><p>6</p></td>
<td><p>6</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>7</p></td>
<td><p>2</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>8</p></td>
<td><p>1</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>9</p></td>
<td><p>1</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>12</p></td>
<td><p>1</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>13</p></td>
<td><p>1</p></td>
<td><p>0.00</p></td>
</tr>
<tr><td><p>16</p></td>
<td><p>1</p></td>
<td><p>0.00</p></td>
</tr>
</tbody>
</table>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Technically, the <a class="reference internal" href="#partof">partOf</a> graph is only directed. In practice, it seems it is also acyclic and something would
probably crash if it wasn't. It is, however, <em>not</em> a vanilla tree as objects can have several parents.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>TODO: Right now I can't make any statements on the equivalency of two <a class="reference internal" href="#partof">partOf</a> relations using the same target
<span class="docutils literal">objectId</span> but each containing different <span class="docutils literal">parts</span> and only one <a class="reference internal" href="#partof">partOf</a> relation using the same target
<span class="docutils literal">objectId</span> but containing the union of both partses .</p>
</div>
</div>
</div>
<div class="section" id="btsrevision">
<h2>BTSRevision</h2>
<p>Internal object used to represent the entries of the <span class="docutils literal">_rev</span> field in a <a class="reference internal" href="#btsdbbaseobject">BTSDBBaseObject</a>. This type incorrectly
inherits from <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
</div>
<div class="section" id="btstimespan">
<h2>BTSTimespan</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btstranslation">
<h2>BTSTranslation</h2>
<p>This type describes a string along with its language. It inherits <span class="docutils literal">_id</span> from <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a> and has its own
two properties. Several <span class="docutils literal">BTSTranslation</span> instances are aggregated into one <a class="reference internal" href="#btstranslations">BTSTranslations</a> instance. Don't confuse
the two!</p>
<dl class="field-list simple">
<dt><span class="docutils literal">lang</span></dt>
<dd><p>The language of this string. This is a ISO 639-1 two-letter language code from the hardcoded <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/core-commons/src/org/bbaw/bts/core/commons/BTSCoreConstants.java#L111-L143">language list in
BTSCoreConstants.java</a>.</p>
</dd>
<dt><span class="docutils literal">value</span></dt>
<dd><p>The string proper</p>
</dd>
</dl>
</div>
<div class="section" id="btstranslations">
<h2>BTSTranslations</h2>
<p>This type describes a string possibly translated into several languages. In contrast to <a class="reference internal" href="#btstranslation">BTSTranslation</a> it is <em>not</em> a
subclass of <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<p>Objects of this type are used in the translation of texts and their constituent words in <a class="reference internal" href="#btssenctence">BTSSenctence</a> and <a class="reference internal" href="#btsword">BTSWord</a>,
in the translation of dictionary entries in <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> and in <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> as a means of internationalization
of small parts of the UI.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">translations</span></dt>
<dd><p>Array of <a class="reference internal" href="#btstranslation">BTSTranslation</a> objects, one for each language present. Note that there is no way to specify the original
string in a set of translations.</p>
</dd>
</dl>
</div>
<div class="section" id="btsuser">
<h2>BTSUser</h2>
<p>This type describes an user account for the BTS. This account is synchronized and used both locally and remote. A
<a class="reference internal" href="#btsuser">BTSUser</a> is a <a class="reference internal" href="#btsobject">BTSObject</a>.</p>
<p>In addition to the specific fields below, some <a class="reference internal" href="#btsuser">BTSUser</a> objects have their inherited <span class="docutils literal">externalReferences</span> field set
to a list containing one <a class="reference internal" href="#btsexternalreference">BTSExternalReference</a> of type <span class="docutils literal">aaew_1</span> with a string-formatted small number that apparently
is this user's ID in a previous incarnation of the BTS.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsuser">BTSUser</a> instances are stored in the <a class="reference internal" href="#global-admin-database">global admin database</a>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">comment</span></dt>
<dd><p>Not used.</p>
</dd>
<dt><span class="docutils literal">dbAdmin</span></dt>
<dd><p>Flag only used during user creation and not manifested in database.</p>
</dd>
<dt><span class="docutils literal">description</span></dt>
<dd><p>Miscellaneous comments. Very rarely used.</p>
</dd>
<dt><span class="docutils literal">groupIds</span></dt>
<dd><p>This is a list of <a class="reference internal" href="#btsusergroup">BTSUserGroup</a> object couchDB ids of groups this user is a member of.</p>
</dd>
<dt><span class="docutils literal">loggedIn</span></dt>
<dd><p>Not used.</p>
</dd>
<dt><span class="docutils literal">mail</span></dt>
<dd><p>This is the email address of this user. This is not always present!</p>
</dd>
<dt><span class="docutils literal">password</span></dt>
<dd><p>This contains the very insecurely encrypted (sic!) password of this user.</p>
</dd>
<dt><span class="docutils literal">sigle</span></dt>
<dd><p>This is a short identifier for this user such as <span class="docutils literal">SDS/AAEW/BBAW</span>. This field is not always present.</p>
</dd>
<dt><span class="docutils literal">status</span></dt>
<dd><p>Not used.</p>
</dd>
<dt><span class="docutils literal">userName</span></dt>
<dd><p>login name of this user. Often this is also the user objects couchDB <span class="docutils literal">_id</span>.</p>
</dd>
<dt><span class="docutils literal">foreName</span></dt>
<dd><p>given name</p>
</dd>
<dt><span class="docutils literal">sureName</span></dt>
<dd><p>surname</p>
</dd>
<dt><span class="docutils literal">webDescription</span></dt>
<dd><p>This contains a human-readable description of this persons's position. This is rarely present.</p>
</dd>
<dt><span class="docutils literal">webURL</span></dt>
<dd><p>This contains an URL to some website where this person may be found. This is rarely present.</p>
</dd>
</dl>
</div>
<div class="section" id="btsusergroup">
<h2>BTSUserGroup</h2>
<p>This type describes a group of users. The group membership is managed in the individual <a class="reference internal" href="#btsuser">BTSUser</a> objects via their
<span class="docutils literal">groupIds</span> field. <a class="reference internal" href="#btsusergroup">BTSUserGroup</a> is a subtype of <a class="reference internal" href="#btsobject">BTSObject</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsusergroup">BTSUserGroup</a> instances are stored in the <a class="reference internal" href="#global-admin-database">global admin database</a>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">name</span></dt>
<dd><p>This field contains the human-readable long-form name of this group, such as <span class="docutils literal"><span class="pre">&quot;Totenbuch-Projekt,</span> Ägyptologisches Seminar der Universität Bonn&quot;</span>.
This field is not present in <span class="docutils literal">terminated</span> groups.</p>
</dd>
<dt><span class="docutils literal">state</span></dt>
<dd><p>Either <span class="docutils literal">active</span> or <span class="docutils literal">terminated</span>.</p>
</dd>
</dl>
</div>
<div class="section" id="btsworkflowrule">
<h2>BTSWorkflowRule</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btsworkflowruleitem">
<h2>BTSWorkflowRuleItem</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="dblease">
<h2>DBLease</h2>
<p>This type is part of the borked locking infrastructure. The basic idea is that a <a class="reference internal" href="#dblease">DBLease</a> instance is automatically
created for every object that is opened in the BTS. This is done via the selection mechanism centered around
<a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/controller-impl/src/org/bbaw/bts/core/controller/impl/generalController/PermissionsAndExpressionsEvaluationControllerImpl.java#L150-L198">setSelection in PermissionsAndExpressionsEvaluationController.java</a>.</p>
<p>The logic behind lock creation (e.g. <a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/core-services-impl/src/org/bbaw/bts/core/services/impl/services/BTSEvaluationServiceImpl.java#L416-L468">acquireLockOptimistic in BTSEvaluationServiceImpl.java</a>) is very racy. Also,
there is no good guarantee that things that are locked are also unlocked in time. And locks expire at some point, and
AFAICT there is noone actively checking when exactly that happens.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#dblease">DBLease</a> instances are stored in the <a class="reference internal" href="#global-notification-database">global notification database</a>.</p>
</div>
</div>
<div class="section" id="useractioncounter">
<h2>UserActionCounter</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This is a purely internal type. It seems to be meant to allow for some history-dependent scheduling of
completions(?) but despite fragments of database infrastructure code it has never been manifested into the database.</p>
</div>
</div>
<div class="section" id="stringtostringlistmap">
<h2>StringToStringListMap</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This is a purely internal type.</p>
</div>
</div>
<div class="section" id="stringtostringmap">
<h2>StringToStringMap</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This is a purely internal type.</p>
</div>
</div>
</div>
<div class="section" id="object-types-of-the-corpus-model">
<h1>Object Types of the Corpus Model</h1>
<p>The corpus model is the second EMF model and the one that contains most of the things an user can actually <em>see</em> and
edit in the UI.</p>
<div class="section" id="btsabstractparagraph">
<h2>BTSAbstractParagraph</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btsabstracttext">
<h2>BTSAbstractText</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>There is a lot of code around this, but it does not seem to be used anywhere.</p>
</div>
</div>
<div class="section" id="btsambivalence">
<h2>BTSAmbivalence</h2>
<p><a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> may be part of a <a class="reference internal" href="#btssenctence">BTSSenctence</a> and describes the case when a text passage is ambiguous, such as
when there are different ways to transliterate or lemmatize or infer flection from it. It contains nothing but an array
of <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> objects in its <span class="docutils literal">cases</span> attribute, each being one of the possibilities of this part of the sentence.</p>
<p><a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> is a subtype of <a class="reference internal" href="#btstextsentenceitem">BTSTextSentenceItem</a>.</p>
<dl class="field-list">
<dt><span class="docutils literal">cases</span></dt>
<dd><p>One <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> for each possible transliteration</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Despite its name this field contains <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> objects, not <a class="reference internal" href="#btsambivalenceitem">BTSAmbivalenceItem</a> objects.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="btsambivalenceitem">
<h2>BTSAmbivalenceItem</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Despite the name suggesting that this is what is found in the <span class="docutils literal">cases</span> field of a <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a>, this in fact
seems to be unused, <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> being used there instead. For type information hava a look at the table under
<a class="reference internal" href="#btstextsentenceitem">BTSTextSentenceItem</a>.</p>
</div>
</div>
<div class="section" id="btsannotation">
<h2>BTSAnnotation</h2>
<p><a class="reference internal" href="#btsannotation">BTSAnnotation</a> is a type describing things such as part of a text or a LemmaEntry. <a class="reference internal" href="#btsannotation">BTSAnnotation</a> is a
<a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> and as such inheriting a whole slew of miscellaneous fields. A <a class="reference internal" href="#btsannotation">BTSAnnotation</a> is put on some object
with a <a class="reference internal" href="#partof">partOf</a> <a class="reference internal" href="#btsrelation">BTSRelation</a>, possibly containing a <span class="docutils literal">parts</span> field.</p>
<p>The usage of <a class="reference internal" href="#btsannotation">BTSAnnotation</a> is a bit patchy.  Following is a list of all nontrivial fields that are used with
<a class="reference internal" href="#btsannotation">BTSAnnotation</a>. The two semantically most relevant fields are <span class="docutils literal">type</span> and <span class="docutils literal">name</span>, as well as the one <a class="reference internal" href="#partof">partOf</a>
<a class="reference internal" href="#btsrelation">BTSRelation</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <a class="reference internal" href="#btsannotation">BTSAnnotation</a> on some object is generally stored in the same database as the target object. This means an
annotation on e.g. a <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> will be stored in the corpuses <a class="reference internal" href="#private-corpus-database">private corpus database</a> while an
annotation on a <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> will be stored in the project's <cite>project word list database</cite>.</p>
<p>There are exceptions to this (such as the Goettingen's metaphor project) that are caused by the inadequate access
control necessitating separate databases.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Do not confuse this with <a class="reference internal" href="#btscomment">BTSComment</a>, which describes a human-readable comment on some object <em>or</em> part of text.</p>
</div>
<div class="section" id="fields-used-with-btsannotation">
<h3>Fields used with BTSAnnotation</h3>
<table>
<colgroup>
<col style="width: 62%" />
<col style="width: 14%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr><th class="head"><p>Field</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>&lt;total&gt;</p></td>
<td><p>13862</p></td>
<td></td>
</tr>
<tr><td><p>state</p></td>
<td><p>13862</p></td>
<td><p>100.00%</p></td>
</tr>
<tr><td><p>type</p></td>
<td><p>10090</p></td>
<td><p>72.79%</p></td>
</tr>
<tr><td><p>name</p></td>
<td><p>8016</p></td>
<td><p>57.83%</p></td>
</tr>
<tr><td><p>corpusPrefix</p></td>
<td><p>5148</p></td>
<td><p>37.14%</p></td>
</tr>
<tr><td><p>passport</p></td>
<td><p>696</p></td>
<td><p>5.02%</p></td>
</tr>
<tr><td><p>subtype</p></td>
<td><p>54</p></td>
<td><p>0.39%</p></td>
</tr>
<tr><td><p>externalReferences[]</p></td>
<td><p>3</p></td>
<td><p>0.02%</p></td>
</tr>
<tr><td><p>sortKey</p></td>
<td><p>2</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="type-values-used-with-btsannotation">
<h3>Type values used with BTSAnnotation</h3>
<table>
<colgroup>
<col style="width: 62%" />
<col style="width: 14%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>&lt;total&gt;</p></td>
<td><p>13862</p></td>
<td></td>
</tr>
<tr><td><p>rubrum</p></td>
<td><p>9927</p></td>
<td><p>71.61%</p></td>
</tr>
<tr><td><p>lexical</p></td>
<td><p>48</p></td>
<td><p>0.35%</p></td>
</tr>
<tr><td><p>textual</p></td>
<td><p>30</p></td>
<td><p>0.22%</p></td>
</tr>
<tr><td><p>conceptual</p></td>
<td><p>29</p></td>
<td><p>0.21%</p></td>
</tr>
<tr><td><p>Annotation-Leipzig</p></td>
<td><p>20</p></td>
<td><p>0.14%</p></td>
</tr>
<tr><td><p>undefined</p></td>
<td><p>13</p></td>
<td><p>0.09%</p></td>
</tr>
<tr><td><p>Layout</p></td>
<td><p>8</p></td>
<td><p>0.06%</p></td>
</tr>
<tr><td><p>&lt;empty&gt;</p></td>
<td><p>7</p></td>
<td><p>0.05%</p></td>
</tr>
<tr><td><p>ConceptualGroup2</p></td>
<td><p>6</p></td>
<td><p>0.04%</p></td>
</tr>
<tr><td><p>ConceptualGroup3</p></td>
<td><p>2</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="type-values-used-with-named-btsannotations">
<h3>Type values used with named BTSAnnotations</h3>
<table>
<colgroup>
<col style="width: 62%" />
<col style="width: 14%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>rubrum</p></td>
<td><p>4352</p></td>
<td><p>54.3%</p></td>
</tr>
<tr><td><p>&lt;null&gt;</p></td>
<td><p>3513</p></td>
<td><p>43.8%</p></td>
</tr>
<tr><td><p>lexical</p></td>
<td><p>44</p></td>
<td><p>0.5%</p></td>
</tr>
<tr><td><p>textual</p></td>
<td><p>28</p></td>
<td><p>0.3%</p></td>
</tr>
<tr><td><p>conceptual</p></td>
<td><p>25</p></td>
<td><p>0.3%</p></td>
</tr>
<tr><td><p>Annotation-Leipzig</p></td>
<td><p>19</p></td>
<td><p>0.2%</p></td>
</tr>
<tr><td><p>undefined</p></td>
<td><p>13</p></td>
<td><p>0.2%</p></td>
</tr>
<tr><td><p>Layout</p></td>
<td><p>8</p></td>
<td><p>0.1%</p></td>
</tr>
<tr><td><p>ConceptualGroup2</p></td>
<td><p>6</p></td>
<td><p>0.1%</p></td>
</tr>
<tr><td><p>&lt;empty string&gt;</p></td>
<td><p>6</p></td>
<td><p>0.1%</p></td>
</tr>
<tr><td><p>ConceptualGroup3</p></td>
<td><p>2</p></td>
<td><p>0.0%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-most-common-names-of-btsannotations">
<h3>The most common names of BTSAnnotations</h3>
<p>The <span class="docutils literal">name</span> of a <a class="reference internal" href="#btsannotation">BTSAnnotation</a> by default contains <span class="docutils literal">&quot;Rubrum&quot;</span>. Otherwise, it is mostly a human-readable comment.
Many a <a class="reference internal" href="#btsannotation">BTSAnnotation</a> does not have a name. Note that <span class="docutils literal">name</span> has a long-tail distribution with very many rarely used
values.</p>
<!-- To extract name statistics: jq -c '.docs[] | select(.eClass == "http://btsCorpusModel/1.0#//BTSAnnotation") | .name | select(. != null)' *.json|sort|uniq -c|sort -rn|head -n 20 -->
<table>
<colgroup>
<col style="width: 55%" />
<col style="width: 16%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr><th class="head"></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr><td><p>&lt;name not null&gt;</p></td>
<td><p>8016</p></td>
<td></td>
</tr>
<tr><td><p>&quot;Rubrum&quot;</p></td>
<td><p>4348</p></td>
<td><p>54.24%</p></td>
</tr>
<tr><td><p>&quot;supralinear&quot;</p></td>
<td><p>177</p></td>
<td><p>2.21%</p></td>
</tr>
<tr><td><p>&quot;Osiris&quot;</p></td>
<td><p>177</p></td>
<td><p>2.21%</p></td>
</tr>
<tr><td><p>&quot;Chiffrenschrift&quot;</p></td>
<td><p>113</p></td>
<td><p>1.41%</p></td>
</tr>
<tr><td><p>&quot;Ptol VIII&quot;</p></td>
<td><p>104</p></td>
<td><p>1.30%</p></td>
</tr>
<tr><td><p>&quot;Textfeld&quot;</p></td>
<td><p>101</p></td>
<td><p>1.26%</p></td>
</tr>
<tr><td><p>&quot;titre&quot;</p></td>
<td><p>75</p></td>
<td><p>0.94%</p></td>
</tr>
<tr><td><p>&quot;Bildfeld&quot;</p></td>
<td><p>63</p></td>
<td><p>0.79%</p></td>
</tr>
<tr><td><p>&quot;griechisch&quot;</p></td>
<td><p>57</p></td>
<td><p>0.71%</p></td>
</tr>
<tr><td><p>&quot;Pehou&quot;</p></td>
<td><p>41</p></td>
<td><p>0.51%</p></td>
</tr>
<tr><td><p>&quot;paroles Osiris&quot;</p></td>
<td><p>39</p></td>
<td><p>0.49%</p></td>
</tr>
<tr><td><p>&quot;Sekhet&quot;</p></td>
<td><p>35</p></td>
<td><p>0.44%</p></td>
</tr>
<tr><td><p>&quot;Kolophon&quot;</p></td>
<td><p>34</p></td>
<td><p>0.42%</p></td>
</tr>
<tr><td><p>&quot;lexical&quot;</p></td>
<td><p>33</p></td>
<td><p>0.41%</p></td>
</tr>
<tr><td><p>&quot;hieratisch&quot;</p></td>
<td><p>31</p></td>
<td><p>0.39%</p></td>
</tr>
<tr><td><p>&quot;Nil&quot;</p></td>
<td><p>30</p></td>
<td><p>0.37%</p></td>
</tr>
<tr><td><p>&quot;nome&quot;</p></td>
<td><p>27</p></td>
<td><p>0.34%</p></td>
</tr>
<tr><td><p>&quot;Isis&quot;</p></td>
<td><p>24</p></td>
<td><p>0.30%</p></td>
</tr>
<tr><td><p>&quot;textual&quot;</p></td>
<td><p>23</p></td>
<td><p>0.29%</p></td>
</tr>
<tr><td><p>&quot;Giebelfeld&quot;</p></td>
<td><p>23</p></td>
<td><p>0.29%</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mapping-between-btsannotation-and-btstext-parts">
<h3>Mapping between BTSAnnotation and BTSText parts</h3>
<p>Almost always, a <a class="reference internal" href="#btsannotation">BTSAnnotation</a> has a single <a class="reference internal" href="#partof">partOf</a> <a class="reference internal" href="#btsrelation">BTSRelation</a> pointing at a <a class="reference internal" href="#btstext">BTSText</a>. There is only two
exceptions in the entire database of which each has two <a class="reference internal" href="#partof">partOf</a> relations. See the following table for the frequency
of <a class="reference internal" href="#btstext">BTSText</a> as a relation target compared to other types.</p>
<!-- To count annotation relations with parts field: jq -c '.docs[] | select(.eClass == "http://btsCorpusModel/1.0#//BTSAnnotation") | .relations[0] | select(has("parts"))' *.json|wc -l -->
<table>
<colgroup>
<col style="width: 71%" />
<col style="width: 13%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>BTSText (total)</p></td>
<td><p>13830</p></td>
<td><p>99.77%</p></td>
</tr>
<tr><td><p>BTSText (Relation has <span class="docutils literal">parts</span> field)</p></td>
<td><p>13796</p></td>
<td><p>99.52%</p></td>
</tr>
<tr><td><p>&lt;unknown&gt;</p></td>
<td><p>15</p></td>
<td><p>0.10%</p></td>
</tr>
<tr><td><p>BTSLemmaEntry</p></td>
<td><p>8</p></td>
<td><p>0.06%</p></td>
</tr>
<tr><td><p>BTSTextCorpus</p></td>
<td><p>5</p></td>
<td><p>0.04%</p></td>
</tr>
<tr><td><p>BTSTCObject</p></td>
<td><p>4</p></td>
<td><p>0.03%</p></td>
</tr>
<tr><td><p>&lt;parts only&gt;</p></td>
<td><p>1</p></td>
<td><p>0.01%</p></td>
</tr>
<tr><td><p>BTSThsEntry</p></td>
<td><p>1</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="btscorpusheader">
<h2>BTSCorpusHeader</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btscorpusobject">
<h2>BTSCorpusObject</h2>
<p>This is the base class for objects that can be shown in one of the tree viewers. This is a subtype of BTSObject, and as
such also includes everything of <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>, <a class="reference internal" href="#administrativdataobject">AdministrativDataObject</a> and <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>:</p>
<pre class="code literal-block"><code>_id, name, type, subtype, sortKey, code, relations, externalReferences, revisions, state, revisionState, visibility</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All instances of <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> is stored in the <a class="reference internal" href="#private-corpus-database">private corpus database</a>.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Do not confuse this with the similarly named <span class="docutils literal">BTSTCObject</span> (from &quot;Text Corpus Object&quot;) or <span class="docutils literal">BTSTextCorpus</span>. Both
are subclasses of <span class="docutils literal">BTSCorpusObject</span>. The later is an individual corpus such as the <span class="docutils literal">bbawfelsinschriften</span> while
the former is something like an annotated folder that is part of a corpus or another folder.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">passport</span></dt>
<dd><p>The BTSPassport of the object. This contains a more-or-less arbitrary, loosely schematized collection of keys and
values describing this object.</p>
</dd>
<dt><span class="docutils literal">corpusPrefix</span></dt>
<dd><p>This field contains the name of the corpus this object is stored in, which corresponds to the couchDB database name.
For example, <span class="docutils literal">bbawfelsinschriften</span> for <span class="docutils literal">aaew_corpus_bbawfelsinschriften</span>. Obviously, maintaining a local copy of
the database name inside every single object is of the highest priority for purposes of data security.</p>
</dd>
<dt><span class="docutils literal">workPhase</span></dt>
<dd><p>Never used.</p>
</dd>
</dl>
</div>
<div class="section" id="btsgraphic">
<h2>BTSGraphic</h2>
<p>This type generally describes a single hieroglyph. Generally, a word is rendered as a sequence of several <a class="reference internal" href="#btsgraphic">BTSGraphic</a>
objects, each containing one component of the word's <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> encoding. Note that since a word's <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> encoding sometimes
contains elements that don't directly map to hieroglyphs such as the <a class="reference external" href="https://en.wikipedia.org/wiki/Cartouche">cartouche</a> markers <span class="docutils literal">&lt;&gt;</span> not every <a class="reference internal" href="#btsgraphic">BTSGraphic</a>
directly maps to a graphical representation. Also note that <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> control characters such as <span class="docutils literal">:</span> or <span class="docutils literal">*</span> are
prepended to the affected <a class="reference internal" href="#btsgraphic">BTSGraphic</a> instance's <span class="docutils literal">code</span>.</p>
<p>Hieroglyphs are rendered by <a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a>. There is some transformation logic that feeds <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> into <a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a> given e.g.
<a class="reference internal" href="#btsword">BTSWord</a> or <a class="reference internal" href="#btssenctence">BTSSenctence</a>. Note that the <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> variant BTS uses in <a class="reference internal" href="#btsgraphic">BTSGraphic</a> is slightly different to the one
<a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a> parses. Due to the one-way nature (<a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> always goes from the BTS into <a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a>) and the particular
implementation the BTS grammar is more lenient than the one of <a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a>. A good starting point to understand this is
<a class="reference external" href="https://github.com/telota/bts/blob/7f7933ae338cbb22553156658823f42e3464dac5/core/corpus-controller-impl/src/org/bbaw/bts/core/corpus/controller/impl/partController/BTSTextEditorControllerImpl.java#L1036-L1115">transformTextToJSeshMdCString in BTSTextEditorControllerImpl.java</a>.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">code</span></dt>
<dd><p>This hieroglyph's <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> string.</p>
</dd>
<dt><span class="docutils literal">ignored</span></dt>
<dd><!-- TODO this -->
</dd>
<dt><span class="docutils literal">innerSentenceOrder</span></dt>
<dd><p>This is an integer field that in rare cases is used to reorder <span class="docutils literal">graphics</span> within a word. When the sentence is
translated into <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> for display, each word's <span class="docutils literal">graphics</span> are passed through a stable sort keyed on
<span class="docutils literal">innerSentenceOrder</span>. This results in the intermediate <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a> representation of the word passed to <a class="reference external" href="https://jsesh.qenherkhopeshef.org/">JSesh</a> being
in a different order. The reason for this is that there are cases of words which are written in hieroglyphs in a
different order than they are pronounced. In the BTS, the oder of words in the database always follows the
pronunciation and transliteration. To allow for the hieroglyph rendering assuming a different order,
<span class="docutils literal">innerSentenceOrder</span> may be set.</p>
</dd>
</dl>
<!-- TODO Add an example to ``innerSentenceOrder`` -->
</div>
<div class="section" id="btsimage">
<h2>BTSImage</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>This seems to be unused.</p>
</div>
</div>
<div class="section" id="btslemmacase">
<h2>BTSLemmaCase</h2>
<p>This type describes one of several alternative transliterations in a <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a>. It is a <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>
and thus also a <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Do not confuse this with <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a>. These two a totally diferrent. <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> describes a single
dictionary entry. <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> one of several alternative transliterations in a <a class="reference internal" href="#btssenctence">BTSSenctence</a> via
<a class="reference internal" href="#btsambivalence">BTSAmbivalence</a>.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">name</span></dt>
<dd><p>This field contains a string with a number identifying this alternative transliteration, e.g. <span class="docutils literal">&quot;1&quot;</span> or <span class="docutils literal">&quot;2&quot;</span>.
This string is entered by a human. This string is equal to the index (starting from 1) of this <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a>
instance in the containing <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> instance's <span class="docutils literal">cases</span> array.</p>
</dd>
<dt><span class="docutils literal">scenario</span></dt>
<dd><p>This field contains the actual transliteration content of this alternative. This field behaves just like
<span class="docutils literal">sentenceItems</span> in <a class="reference internal" href="#btssenctence">BTSSenctence</a> with the exception that in practice, a <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> instance does not
contain other <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> instances.</p>
</dd>
</dl>
</div>
<div class="section" id="btslemmaentry">
<h2>BTSLemmaEntry</h2>
<p>This type describes a single lemma in the project's dictionary. It is a direct subtype of <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> and as
such uses many of its fields including the passport.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> instances are stored in the <a class="reference internal" href="#project-word-list-database">project word list database</a>.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Do not confuse this with <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a>. These two a totally diferrent. <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> describes a single
dictionary entry. <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> one of several alternative transliterations in a <a class="reference internal" href="#btssenctence">BTSSenctence</a> via
<a class="reference internal" href="#btsambivalence">BTSAmbivalence</a>.</p>
</div>
<div class="section" id="notable-inherited-fields">
<h3>Notable inherited fields</h3>
<dl class="field-list">
<dt><span class="docutils literal">type</span></dt>
<dd><p></p></dd>
<dt><span class="docutils literal">subtype</span></dt>
<dd><p>These are used to express the word type of this entry such as <span class="docutils literal">substantive</span> or <span class="docutils literal">adjective</span> for <span class="docutils literal">type</span> and
<span class="docutils literal"><span class="pre">verb_4-inf</span></span> or <span class="docutils literal">kings_name</span> for <span class="docutils literal">subtype</span>.  Possible values are enumerated in the <a class="reference internal" href="#btsconfig">BTSConfig</a> under
<span class="docutils literal">√.objectTypes.Lemma</span>.</p>
</dd>
<dt><span class="docutils literal">name</span></dt>
<dd><p>This field contains the unicode transliteration of the lemma's egyptian pronunciation.</p>
</dd>
<dt><span class="docutils literal">revisionState</span></dt>
<dd><p>This field contains a lifecycle state for this entry.</p>
<table>
<colgroup>
<col style="width: 64%" />
<col style="width: 13%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr><th class="head"><p>revisionState</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>published</p></td>
<td><p>44082</p></td>
<td><p>100.00%</p></td>
</tr>
<tr><td><p>published-awaiting-review</p></td>
<td><p>16440</p></td>
<td><p>37.29%</p></td>
</tr>
<tr><td><p>published-obsolete</p></td>
<td><p>7052</p></td>
<td><p>16.00%</p></td>
</tr>
<tr><td><p>obsolete</p></td>
<td><p>753</p></td>
<td><p>1.71%</p></td>
</tr>
<tr><td><p>awaiting-review</p></td>
<td><p>16</p></td>
<td><p>0.04%</p></td>
</tr>
<tr><td><p>new</p></td>
<td><p>6</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
</dd>
<dt><span class="docutils literal">relations</span></dt>
<dd><p>While the rest of the BTS exclusively uses <a class="reference internal" href="#partof">partOf</a> <a class="reference internal" href="#btsrelation">relations</a>, lemmata heavily use all sorts of relations. Below is
a list detailing how many <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> there are with a given number of <a class="reference internal" href="#btsrelation">relations</a>.</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 18%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr><th class="head"><p># of relations</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>0</p></td>
<td><p>47070</p></td>
<td><p>69.97%</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>12498</p></td>
<td><p>18.58%</p></td>
</tr>
<tr><td><p>2</p></td>
<td><p>4221</p></td>
<td><p>6.27%</p></td>
</tr>
<tr><td><p>3</p></td>
<td><p>1379</p></td>
<td><p>2.05%</p></td>
</tr>
<tr><td><p>4</p></td>
<td><p>704</p></td>
<td><p>1.05%</p></td>
</tr>
<tr><td><p>5</p></td>
<td><p>369</p></td>
<td><p>0.55%</p></td>
</tr>
<tr><td><p>6</p></td>
<td><p>240</p></td>
<td><p>0.36%</p></td>
</tr>
<tr><td><p>7</p></td>
<td><p>137</p></td>
<td><p>0.20%</p></td>
</tr>
<tr><td><p>8</p></td>
<td><p>129</p></td>
<td><p>0.19%</p></td>
</tr>
<tr><td><p>9</p></td>
<td><p>69</p></td>
<td><p>0.10%</p></td>
</tr>
<tr><td><p>...</p></td>
<td></td>
<td></td>
</tr>
<tr><td><p>71</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>73</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>75</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>77</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
<tr><td><p>91</p></td>
<td><p>1</p></td>
<td><p>0.00%</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="specific-fields">
<h3>Specific fields</h3>
<dl class="field-list">
<dt><span class="docutils literal">translations</span></dt>
<dd><p>This field contains a <a class="reference internal" href="#btstranslations">BTSTranslations</a> object containing all the translations of this entry into several languages.</p>
</dd>
<dt><span class="docutils literal">words</span></dt>
<dd><p>This field contains the words of this entry. A <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> of a compound word should ideally consist of several
words, however there is no mechanism that guarantees this.</p>
<p>In many cases, the latter entries of <span class="docutils literal">words</span> have their <span class="docutils literal">wChar</span> field surrounded by parentheses as in <span class="docutils literal">(foo)</span>.
This is to mark collocations in specializations of a verb. That is, a verb <span class="docutils literal">have</span> that has a broad meaning is
present in the word list with one generic entry for the verb and with a number of specialized entries, one for each
collocation and meaning <span class="docutils literal">have (kittens)</span>. These cases are also expressed through <a class="reference internal" href="#partof">partOf</a> and <span class="docutils literal">contains</span>
<a class="reference internal" href="#btsrelation">relations</a>.</p>
<p>Below is a table of how many entries there are with a given length of <span class="docutils literal">words</span>.</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 25%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr><th class="head"><p>Length</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>1</p></td>
<td><p>50689</p></td>
<td><p>97.11%</p></td>
</tr>
<tr><td><p>2</p></td>
<td><p>1223</p></td>
<td><p>2.34%</p></td>
</tr>
<tr><td><p>3</p></td>
<td><p>185</p></td>
<td><p>0.35%</p></td>
</tr>
<tr><td><p>4</p></td>
<td><p>45</p></td>
<td><p>0.09%</p></td>
</tr>
<tr><td><p>0</p></td>
<td><p>24</p></td>
<td><p>0.05%</p></td>
</tr>
<tr><td><p>5</p></td>
<td><p>19</p></td>
<td><p>0.04%</p></td>
</tr>
<tr><td><p>6</p></td>
<td><p>7</p></td>
<td><p>0.01%</p></td>
</tr>
<tr><td><p>7</p></td>
<td><p>6</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Note that there are many cases of entries that have several words where all hieroglyphs are bunched into the
first word, and the later words only contain <a class="reference external" href="https://en.wikipedia.org/wiki/Manuel_de_Codage">MdC</a>. This is an artifact of the initial data import.</p>
</div>
</dd>
<dt><span class="docutils literal">ignore</span></dt>
<dd><p>This field is unused.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="btsmarker">
<h2>BTSMarker</h2>
<p>This type describes a marker such as &quot;begin of sentence&quot; or &quot;this is line number $foo&quot;. It is a possible element in the
<span class="docutils literal">sentenceItems</span> array of a <a class="reference internal" href="#btssenctence">BTSSenctence</a> or the <span class="docutils literal">scenario</span> array of a <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a>. <a class="reference internal" href="#btsmarker">BTSMarker</a> is a subtype
of <a class="reference internal" href="#administrativdataobject">AdministrativDataObject</a> and <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a> and thus in turn <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>. Note that the <span class="docutils literal">type</span>
and <span class="docutils literal">name</span> fields of <a class="reference internal" href="#btsmarker">BTSMarker</a> is used totally differently than the <span class="docutils literal">type</span> and <span class="docutils literal">name</span> fields of
<a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">type</span></dt>
<dd><p></p></dd>
<dt><span class="docutils literal">name</span></dt>
<dd><p>Both these fields are used to contain human-readable, non-standardized comment on this marker's function</p>
</dd>
</dl>
<!-- TODO properly understand how both of these are used in practice. -->
<dl class="field-list simple">
<dt><span class="docutils literal">value</span></dt>
<dd><p>Almost never used.</p>
</dd>
</dl>
</div>
<div class="section" id="btspassport">
<h2>BTSPassport</h2>
<p><a class="reference internal" href="#btspassport">BTSPassport</a> is a type describing attributes on a <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a>. The attributes in a <a class="reference internal" href="#btspassport">BTSPassport</a> instance are
of form key➜value and may be categorized into nested named groups. A loose schema of this (which keys are allowed, in
which groups they may occur) is described in the <a class="reference internal" href="#btsconfig">BTSConfig</a>. 95.61% of roughly 1M attributes conform to this schema,
4.39% or roughly 40k do not. Below is a list of all attribute paths that do not conform to the schema in the
<a class="reference internal" href="#btsconfig">BTSConfig</a>.</p>
<table>
<colgroup>
<col style="width: 72%" />
<col style="width: 12%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr><th class="head"><p>Attribute path</p></th>
<th class="head"><p>count</p></th>
<th class="head"><p>percentage</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>√.object.description_of_object→copy</p></td>
<td><p>169</p></td>
<td><p>0.02</p></td>
</tr>
<tr><td><p>√.object.description_of_object→agent</p></td>
<td><p>3165</p></td>
<td><p>0.34</p></td>
</tr>
<tr><td><p>√.object.description_of_object→&lt;none&gt;</p></td>
<td><p>2016</p></td>
<td><p>0.21</p></td>
</tr>
<tr><td><p>√.thesaurus.main_group→old_id</p></td>
<td><p>3442</p></td>
<td><p>0.37</p></td>
</tr>
<tr><td><p>√.thesaurus.main_group→old_thesaurus_number</p></td>
<td><p>3442</p></td>
<td><p>0.37</p></td>
</tr>
<tr><td><p>√.thesaurus.main_group→termsort</p></td>
<td><p>3442</p></td>
<td><p>0.37</p></td>
</tr>
<tr><td><p>√.text.textual_metadata→egyTextName</p></td>
<td><p>25676</p></td>
<td><p>2.73</p></td>
</tr>
</tbody>
</table>
<div class="section" id="passport-key-graph">
<h3>Passport Key Graph</h3>
<!-- TODO fix this graph. It seems it is not displayed correctly in the rendered HTML. -->
<div class="figure">
<a class="reference external image-reference" href="graphs/passport_graph_mapped.pdf"><img alt="graphs/passport_graph_mapped.png" src="graphs/passport_graph_mapped.png" style="width: 100%;" /></a>
<p class="caption">A Graph of passport attribute paths found in actual live data.</p>
</div>
<dl class="field-list simple">
<dt><span class="docutils literal">children</span></dt>
<dd><p>A list of <a class="reference internal" href="#btspassportentrygroup">BTSPassportEntryGroup</a> instances</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="btspassportentry">
<h2>BTSPassportEntry</h2>
<p>This type is a simple superclass of <a class="reference internal" href="#btspassportentryitem">BTSPassportEntryItem</a> and <a class="reference internal" href="#btspassportentrygroup">BTSPassportEntryGroup</a>. It is a subtype of
<a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<!-- ATTENTION: Do not confuse `BTSPassportEntry`_ and its subtype `BTSPassportEntryItem`_. -->
</div>
<div class="section" id="btspassportentrygroup">
<h2>BTSPassportEntryGroup</h2>
<p>This type describes a group of <a class="reference internal" href="#btspassportentry">BTSPassportEntry</a> objects in a <a class="reference internal" href="#btspassport">BTSPassport</a> or nested in another
<a class="reference internal" href="#btspassportentrygroup">BTSPassportEntryGroup</a>. <a class="reference internal" href="#btspassportentrygroup">BTSPassportEntryGroup</a> is a subtype of <a class="reference internal" href="#btspassportentry">BTSPassportEntry</a> and in turn
<a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">type</span></dt>
<dd><p>The key of this group. This is the same as the <span class="docutils literal">value</span> attribute of the <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> instance corresponding to
the node of this attribute in the schema in the <a class="reference internal" href="#btsconfig">BTSConfig</a>.</p>
</dd>
<dt><span class="docutils literal">children</span></dt>
<dd><p>A list of <a class="reference internal" href="#btspassportentrygroup">BTSPassportEntryGroup</a> and further nested <cite>BTSPassportEntryGroup</cite> instances (possibly both types). This
hierarchy seems to be mostly just 2-3 levels deep.</p>
</dd>
</dl>
<!-- ATTENTION: The ``type`` attribute is used differently than in `BTSNamedTypedObject`_ here. -->
</div>
<div class="section" id="btspassportentryitem">
<h2>BTSPassportEntryItem</h2>
<p>This type describes a single key→value attribute in a <a class="reference internal" href="#btspassport">BTSPassport</a>. <a class="reference internal" href="#btspassportentryitem">BTSPassportEntryItem</a> is a subtype of
<a class="reference internal" href="#btspassportentry">BTSPassportEntry</a> and in turn <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a>.</p>
<!-- ATTENTION: Do not confuse `BTSPassportEntry`_ and its subtype `BTSPassportEntryItem`_. -->
<dl class="field-list simple">
<dt><span class="docutils literal">type</span></dt>
<dd><p>The key of this attribute. This is the same as the <span class="docutils literal">value</span> attribute of the <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> instance
corresponding to the node of this attribute in the schema in the <a class="reference internal" href="#btsconfig">BTSConfig</a>.</p>
</dd>
<dt><span class="docutils literal">value</span></dt>
<dd><p>The actual string value of this attribute.</p>
</dd>
</dl>
<!-- ATTENTION: The ``type`` attribute is used differently than in `BTSNamedTypedObject`_ here. -->
</div>
<div class="section" id="btssenctence">
<h2>BTSSenctence</h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is actually written BTSSen*c*tence.</p>
</div>
<p>A <a class="reference internal" href="#btssenctence">BTSSenctence</a> (sic!) is the basic element of a <a class="reference internal" href="#btstext">BTSText</a>. It consists of a list of <a class="reference internal" href="#btssentenceitem">BTSSentenceItem</a> objects along
translations into a number of languages. <a class="reference internal" href="#btssenctence">BTSSenctence</a> is a subtype of <a class="reference internal" href="#btstextitems">BTSTextItems</a>.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">sentenceItems</span></dt>
<dd><p></p></dd>
<dt><span class="docutils literal">translation</span></dt>
<dd><p>The multilingual translations of this sentence as a <a class="reference internal" href="#btstranslations">BTSTranslations</a> object.</p>
</dd>
</dl>
</div>
<div class="section" id="btssentenceitem">
<h2>BTSSentenceItem</h2>
<p>This is an interface meant to bundle a bunch of stuff that could theoretically be put into a <a class="reference internal" href="#btssenctence">BTSSenctence</a>. It
directly inherits from <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>. For details see <a class="reference internal" href="#btstextsentenceitem">BTSTextSentenceItem</a>.</p>
</div>
<div class="section" id="btstcobject">
<h2>BTSTCObject</h2>
<div class="admonition attention">
<p class="admonition-title">Attention!</p>
<p>Try to not confuse this with <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a>, <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a>, <a class="reference internal" href="#btstextcontent">BTSTextContent</a> or <a class="reference internal" href="#btsobject">BTSObject</a>.</p>
</div>
<p><a class="reference internal" href="#btstcobject">BTSTCObject</a> (&quot;Berlin Text System Text Corpus Object&quot;) is a <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> describing what is logically very
similar to a folder with other computer things. Semantically, in general a <a class="reference internal" href="#btstcobject">BTSTCObject</a> maps to some physical place or
thing and its <a class="reference internal" href="#btstcobject">BTSTCObject</a> descendants are parts of it. Example: <span class="docutils literal">〈Pyramidentexte〉</span> contains <span class="docutils literal">Pyramide Pepis I.</span>
contains <span class="docutils literal">〈Sargkammer〉</span> contains <span class="docutils literal"><span class="pre">〈&quot;Wartesaal&quot;/vestibule〉</span></span> contains <span class="docutils literal">〈Westwand〉</span> contains 26 <a class="reference internal" href="#btstext">BTSText</a>
instances. As you can see there is no particular schema to these names, and ever representing them in some sort of path
language will be quite challenging due to their liberal use of weird characters.</p>
<p>A <a class="reference internal" href="#btstcobject">BTSTCObject</a> notably may possess a <a class="reference internal" href="#btspassport">BTSPassport</a> describing what effects to extended object metadata. It does not
have any fields beyond what it inherits from <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a>.</p>
<p>As usual, hierarchy is expressed using a <a class="reference internal" href="#partof">partOf</a> <a class="reference internal" href="#btsrelation">BTSRelation</a>. As follows there are rare cases of multiple ancestors
that make this graph not be a tree.</p>
<table>
<colgroup>
<col style="width: 60%" />
<col style="width: 14%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr><th class="head"><p># of partOf Relations</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>&lt;total&gt;</p></td>
<td><p>16008</p></td>
<td><p>100.00%</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>15988</p></td>
<td><p>99.88%</p></td>
</tr>
<tr><td><p>2</p></td>
<td><p>19</p></td>
<td><p>0.12%</p></td>
</tr>
<tr><td><p>3</p></td>
<td><p>1</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
<div class="section" id="types-values-used-with-btstcobject">
<h3>Types values used with BTSTCObject</h3>
<table>
<colgroup>
<col style="width: 44%" />
<col style="width: 20%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>&lt;total&gt;</p></td>
<td><p>16008</p></td>
<td></td>
</tr>
<tr><td><p>TCObject</p></td>
<td><p>8239</p></td>
<td><p>51.47%</p></td>
</tr>
<tr><td><p>ObjectPart</p></td>
<td><p>4175</p></td>
<td><p>26.08%</p></td>
</tr>
<tr><td><p>Caption</p></td>
<td><p>1445</p></td>
<td><p>9.03%</p></td>
</tr>
<tr><td><p>Scene</p></td>
<td><p>1281</p></td>
<td><p>8.00%</p></td>
</tr>
<tr><td><p>Group</p></td>
<td><p>327</p></td>
<td><p>2.04%</p></td>
</tr>
<tr><td><p>Arrangement</p></td>
<td><p>166</p></td>
<td><p>1.04%</p></td>
</tr>
<tr><td><p>TCSuperText</p></td>
<td><p>34</p></td>
<td><p>0.21%</p></td>
</tr>
<tr><td><p>&lt;empty&gt;</p></td>
<td><p>2</p></td>
<td><p>0.01%</p></td>
</tr>
<tr><td><p>undefined</p></td>
<td><p>1</p></td>
<td><p>0.01%</p></td>
</tr>
</tbody>
</table>
<p>A <a class="reference internal" href="#btstcobject">BTSTCObject</a>'s type manifests itself in the icon displayed for this object in the tree viewer.</p>
</div>
</div>
<div class="section" id="btstext">
<h2>BTSText</h2>
<p>This type describes a single text. It is a subtype of <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> and uses most of the fields defined there. The
actual text content is contained as a list of sentences in the <span class="docutils literal">textItems</span> field of the <a class="reference internal" href="#btstextcontent">BTSTextContent</a> instance in
this object's <span class="docutils literal">textContent</span> field.</p>
<p>Note that as <a class="reference internal" href="#btstext">BTSText</a> inherits from <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> it can have its own passport filled with information and it is
displayed in the object browser. Everything below <a class="reference internal" href="#btstext">BTSText</a> such as <a class="reference internal" href="#btssenctence">BTSSenctence</a> or <a class="reference internal" href="#btsword">BTSWord</a> objects is not a
<a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> and thus cannot be navigated to in the object browser and cannot hold its own passport.</p>
<dl class="field-list simple">
<dt><span class="docutils literal">textContent</span></dt>
<dd><p>A <a class="reference internal" href="#btstextcontent">BTSTextContent</a> object. Technically, this is a list of <a class="reference internal" href="#btstextitems">BTSTextItems</a> objects each of which could be either a
<a class="reference internal" href="#btssenctence">BTSSenctence</a>, a <a class="reference internal" href="#btsambivalence">BTSAmbivalence</a> or a <a class="reference internal" href="#btsmarker">BTSMarker</a>. Luckily, in practice the immediate contents of this are
exclusively <a class="reference internal" href="#btssenctence">BTSSenctence</a> instances.</p>
</dd>
</dl>
</div>
<div class="section" id="btstextcontent">
<h2>BTSTextContent</h2>
<p>This type is a simple container for a list of <a class="reference internal" href="#btssenctence">BTSSenctence</a> objects. It is a very basic EObject.</p>
</div>
<div class="section" id="btstextcorpus">
<h2>BTSTextCorpus</h2>
<p>A <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> is sort of a top-level folder for <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> instances. A <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> belongs to exactly
one <a class="reference internal" href="#btsproject">BTSProject</a>. It is a basic <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> with two quirks: It may contain a <a class="reference internal" href="#btscorpusheader">BTSCorpusHeader</a> (which in
practice it never does) and it has a flag <span class="docutils literal">active</span> that is not persisted in the database. The list of active corpora
is stored in the app's preferences.</p>
<p>Each <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> has its own CouchDB database (i.e. database within the same CouchDB instance). The association
between a <a class="reference internal" href="#btsproject">BTSProject</a> and its corpora is done via the names of these databases. The format is <span class="docutils literal">{project name}_corpus_{corpus name}</span>, e.g. <span class="docutils literal">aaew_corpus_bbawgrabinschriften</span>. When anything is loaded from a corpuses
database, the non-persisted <a class="reference internal" href="#dbcollectionkey">DBCollectionKey</a> field inherited from <a class="reference internal" href="#btsdbbaseobject">BTSDBBaseObject</a> is set to the database name. The
content of this field is later used to access the project.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A corpuses <a class="reference internal" href="#btstextcorpus">BTSTextCorpus</a> instance is stored in the <a class="reference internal" href="#project-corpus-index-database">project corpus index database</a>.</p>
</div>
</div>
<div class="section" id="btstextitems">
<h2>BTSTextItems</h2>
<p>This is an interface meant to bundle a bunch of stuff that could theoretically be put into a text. It directly inherits
from <a class="reference internal" href="#administrativdataobject">AdministrativDataObject</a> and <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a> and thus only <em>nearly</em> is a <a class="reference internal" href="#btsobject">BTSObject</a>. For details see
<a class="reference internal" href="#btstextsentenceitem">BTSTextSentenceItem</a></p>
</div>
<div class="section" id="btstextsentenceitem">
<h2>BTSTextSentenceItem</h2>
<p>This is an interface combining <a class="reference internal" href="#btstextitems">BTSTextItems</a> and <a class="reference internal" href="#btssentenceitem">BTSSentenceItem</a>, supposedly meant to describe types implementing
both. In practice it is not really used as all two usages also directly implement its super-interfaces. Following is a
table of types and which of this group of interfaces they implement</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 16%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr><th class="head"><p>Type</p></th>
<th class="head"><p>Is a <a class="reference internal" href="#btssentenceitem">BTSSentenceItem</a>?</p></th>
<th class="head"><p>Is a <a class="reference internal" href="#btstextitems">BTSTextItems</a>?</p></th>
<th class="head"><p>Is a <a class="reference internal" href="#btstextsentenceitem">BTSTextSentenceItem</a>?</p></th>
<th class="head"><p>Is a <a class="reference internal" href="#btsambivalenceitem">BTSAmbivalenceItem</a>?</p></th>
</tr>
</thead>
<tbody>
<tr><td><p><a class="reference internal" href="#btsmarker">BTSMarker</a></p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsambivalence">BTSAmbivalence</a></p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
<td><p>✘</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btsword">BTSWord</a></p></td>
<td><p>✔</p></td>
<td><p>✘</p></td>
<td><p>✘</p></td>
<td><p>✔</p></td>
</tr>
<tr><td><p><a class="reference internal" href="#btssenctence">BTSSenctence</a></p></td>
<td><p>✘</p></td>
<td><p>✔</p></td>
<td><p>✘</p></td>
<td><p>✘</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="btsthsentry">
<h2>BTSThsEntry</h2>
<p><a class="reference internal" href="#btsthsentry">BTSThsEntry</a> (Berlin Text System Thesaurus Entry) is a subtype of <a class="reference internal" href="#btscorpusobject">BTSCorpusObject</a> not containing any fields of its
own that describes a semantically sensible value that can be put into some particular passport field. See
<a class="reference internal" href="#ownerreferencedtypesstringlist">ownerReferencedTypesStringList</a> in <a class="reference internal" href="#btsconfigitem">BTSConfigItem</a> and <a class="reference internal" href="#select-from-thesaurus">Select from Thesaurus</a> in <a class="reference internal" href="#btspassporteditorconfig">BTSPassportEditorConfig</a> for
details on how the corpus side of things looks.</p>
<p>In practice, all instances <a class="reference internal" href="#btsthsentry">BTSThsEntry</a> are organized into subtrees via <a class="reference internal" href="#partof">partOf</a> relations. All entries in one
subtree share one <span class="docutils literal">type</span> and describe all the possible values that a particular type of passport field may assume.
Within subtrees the entries are organized into some semantically sensible hierarchy. For example, the <span class="docutils literal">findSpot</span>
entries in <span class="docutils literal">3 = Fundstellen</span> are organized according to their geographical hierarchy. <span class="docutils literal">3 = Fundstellen</span> contains
<span class="docutils literal">Wüste östlich des Niltals und Küste des Roten Meeres (Staatsgebiet Ägypten und Sudan)</span> contains <span class="docutils literal">Routen zum Roten Meer</span> contains <span class="docutils literal">Wadi Abbad</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There may be BTSThsEntry objects without parents. Also there might be some with several parents. Just keep that in
mind.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All <a class="reference internal" href="#btsthsentry">BTSThsEntry</a> instances are stored in the <a class="reference internal" href="#project-thesaurus-database">project thesaurus database</a>.</p>
</div>
</div>
<div class="section" id="btsword">
<h2>BTSWord</h2>
<p><a class="reference internal" href="#btsword">BTSWord</a> is a type describing a single transliteration of a single egyptian word.  It is a possible element in the
<span class="docutils literal">sentenceItems</span> array of a <a class="reference internal" href="#btssenctence">BTSSenctence</a> or the <span class="docutils literal">scenario</span> array of a <a class="reference internal" href="#btslemmacase">BTSLemmaCase</a> (transliteration
alternative), and it can be in <span class="docutils literal">words</span> of a <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> (dictionary entry).</p>
<p><a class="reference internal" href="#btsword">BTSWord</a> is a subtype of <a class="reference internal" href="#btsidentifiableitem">BTSIdentifiableItem</a> and <a class="reference internal" href="#btsnamedtypedobject">BTSNamedTypedObject</a>. Despite this, <span class="docutils literal">name</span> or <span class="docutils literal">type</span> are
never used with it.</p>
<!-- TODO check the definition of this with Jakob and Simon -->
<dl class="field-list">
<dt><span class="docutils literal">lKey</span></dt>
<dd><p>This field is mostly used when this <a class="reference internal" href="#btsword">BTSWord</a> is part of a transliteration in a <a class="reference internal" href="#btstext">BTSText</a>. If this <a class="reference internal" href="#btsword">BTSWord</a> is
part of a <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a>, this field is null most of the time but may point to other entries in case of a compound
word.</p>
<p>This field contains the couchDB object <span class="docutils literal">_id</span> of the <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> this word can be found in. Note that
<a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> object ids are human-readable short numbers (5-6 digit) that also serve as human-readable
dictionary keys.</p>
</dd>
<dt><span class="docutils literal">flexCode</span></dt>
<dd><p>This field may be used when this <a class="reference internal" href="#btsword">BTSWord</a> is part of a transliteration in a <a class="reference internal" href="#btstext">BTSText</a> or in a composite
<a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a>. In most <a class="reference internal" href="#btslemmaentry">BTSLemmaEntry</a> objects, this field null.</p>
</dd>
</dl>
<!-- TODO explain this, and where it comes from -->
<dl class="field-list simple">
<dt><span class="docutils literal">wChar</span></dt>
<dd><p>This field contains this word's unicode transliteration, such as <span class="docutils literal"><span class="pre">&quot;pꜣy=j-nb-n-ꜥḏdjw&quot;</span></span>. The grammar of this is
rather complex and differs depending on whether this is part of a text transliteration or a dictionary entry.</p>
</dd>
<dt><span class="docutils literal">translation</span></dt>
<dd><p>This field contains a <a class="reference internal" href="#btstranslations">BTSTranslations</a> instance with all translations of this word.</p>
</dd>
<dt><span class="docutils literal">graphics</span></dt>
<dd><p>This field contains a list <a class="reference internal" href="#btsgraphic">BTSGraphic</a> objects that when concatenated make up this word.</p>
</dd>
</dl>
</div>
</div>
</div>
</body>
</html>
